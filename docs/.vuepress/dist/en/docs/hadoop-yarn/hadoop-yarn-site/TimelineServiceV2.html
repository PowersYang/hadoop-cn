<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>The YARN Timeline Service v.2 | Hadoop Chinese Website</title>
    <meta name="description" content="Hadoop Chinese Website, Hadoop Chinese community.">
    
    
    <link rel="preload" href="/assets/css/0.styles.74fd5345.css" as="style"><link rel="preload" href="/assets/js/app.2396613b.js" as="script"><link rel="preload" href="/assets/js/2.8cd1edd2.js" as="script"><link rel="preload" href="/assets/js/250.1172f0d2.js" as="script"><link rel="prefetch" href="/assets/js/10.d1e9cb36.js"><link rel="prefetch" href="/assets/js/100.5b089701.js"><link rel="prefetch" href="/assets/js/101.44bb8117.js"><link rel="prefetch" href="/assets/js/102.9b80af65.js"><link rel="prefetch" href="/assets/js/103.d1708b0d.js"><link rel="prefetch" href="/assets/js/104.e1845ba0.js"><link rel="prefetch" href="/assets/js/105.e87a31d6.js"><link rel="prefetch" href="/assets/js/106.cb6b8d79.js"><link rel="prefetch" href="/assets/js/107.33761100.js"><link rel="prefetch" href="/assets/js/108.23a38edb.js"><link rel="prefetch" href="/assets/js/109.b9c1c3e0.js"><link rel="prefetch" href="/assets/js/11.ded79230.js"><link rel="prefetch" href="/assets/js/110.938fb5ad.js"><link rel="prefetch" href="/assets/js/111.8c8349ca.js"><link rel="prefetch" href="/assets/js/112.6b58b188.js"><link rel="prefetch" href="/assets/js/113.f24fffd3.js"><link rel="prefetch" href="/assets/js/114.fe548485.js"><link rel="prefetch" href="/assets/js/115.d2e69e60.js"><link rel="prefetch" href="/assets/js/116.8827c4a2.js"><link rel="prefetch" href="/assets/js/117.f60ad574.js"><link rel="prefetch" href="/assets/js/118.7c297ba4.js"><link rel="prefetch" href="/assets/js/119.4a34ba9c.js"><link rel="prefetch" href="/assets/js/12.e45cbf81.js"><link rel="prefetch" href="/assets/js/120.6ac6a637.js"><link rel="prefetch" href="/assets/js/121.16161da0.js"><link rel="prefetch" href="/assets/js/122.efb675f6.js"><link rel="prefetch" href="/assets/js/123.4277c9f7.js"><link rel="prefetch" href="/assets/js/124.7bfcdbfa.js"><link rel="prefetch" href="/assets/js/125.59af84e2.js"><link rel="prefetch" href="/assets/js/126.e9454c6b.js"><link rel="prefetch" href="/assets/js/127.eefb2c1d.js"><link rel="prefetch" href="/assets/js/128.b2b9293c.js"><link rel="prefetch" href="/assets/js/129.66dde54f.js"><link rel="prefetch" href="/assets/js/13.b5891907.js"><link rel="prefetch" href="/assets/js/130.a0488add.js"><link rel="prefetch" href="/assets/js/131.d700e93d.js"><link rel="prefetch" href="/assets/js/132.a19a2822.js"><link rel="prefetch" href="/assets/js/133.34ca8b99.js"><link rel="prefetch" href="/assets/js/134.c7facc8b.js"><link rel="prefetch" href="/assets/js/135.dab118e5.js"><link rel="prefetch" href="/assets/js/136.20d61ad9.js"><link rel="prefetch" href="/assets/js/137.829b7919.js"><link rel="prefetch" href="/assets/js/138.1524d621.js"><link rel="prefetch" href="/assets/js/139.8da4cfd7.js"><link rel="prefetch" href="/assets/js/14.318056ac.js"><link rel="prefetch" href="/assets/js/140.0d4f6981.js"><link rel="prefetch" href="/assets/js/141.f7f944f7.js"><link rel="prefetch" href="/assets/js/142.66c005d0.js"><link rel="prefetch" href="/assets/js/143.bd1a205b.js"><link rel="prefetch" href="/assets/js/144.7860704d.js"><link rel="prefetch" href="/assets/js/145.1bed1388.js"><link rel="prefetch" href="/assets/js/146.907b0f7c.js"><link rel="prefetch" href="/assets/js/147.6438d860.js"><link rel="prefetch" href="/assets/js/148.634586c1.js"><link rel="prefetch" href="/assets/js/149.7c2e7f27.js"><link rel="prefetch" href="/assets/js/15.f1495a71.js"><link rel="prefetch" href="/assets/js/150.c4ba908e.js"><link rel="prefetch" href="/assets/js/151.2fdb1d43.js"><link rel="prefetch" href="/assets/js/152.6bb37c33.js"><link rel="prefetch" href="/assets/js/153.2e0d52cb.js"><link rel="prefetch" href="/assets/js/154.5dda3620.js"><link rel="prefetch" href="/assets/js/155.18993967.js"><link rel="prefetch" href="/assets/js/156.ca1564fc.js"><link rel="prefetch" href="/assets/js/157.f45532ec.js"><link rel="prefetch" href="/assets/js/158.3a010a63.js"><link rel="prefetch" href="/assets/js/159.012e93b5.js"><link rel="prefetch" href="/assets/js/16.4fccac8b.js"><link rel="prefetch" href="/assets/js/160.92f2f245.js"><link rel="prefetch" href="/assets/js/161.f8d1fee8.js"><link rel="prefetch" href="/assets/js/162.201b7c5c.js"><link rel="prefetch" href="/assets/js/163.faf8a180.js"><link rel="prefetch" href="/assets/js/164.ca4dfe68.js"><link rel="prefetch" href="/assets/js/165.e70cb4ba.js"><link rel="prefetch" href="/assets/js/166.4bfb5966.js"><link rel="prefetch" href="/assets/js/167.1220c1f5.js"><link rel="prefetch" href="/assets/js/168.b9eda141.js"><link rel="prefetch" href="/assets/js/169.b51bb4d0.js"><link rel="prefetch" href="/assets/js/17.ee173f65.js"><link rel="prefetch" href="/assets/js/170.e7ec2e50.js"><link rel="prefetch" href="/assets/js/171.3fd70b56.js"><link rel="prefetch" href="/assets/js/172.15458599.js"><link rel="prefetch" href="/assets/js/173.38268430.js"><link rel="prefetch" href="/assets/js/174.6183d84e.js"><link rel="prefetch" href="/assets/js/175.0f46e67e.js"><link rel="prefetch" href="/assets/js/176.73a288df.js"><link rel="prefetch" href="/assets/js/177.c9fc6dbc.js"><link rel="prefetch" href="/assets/js/178.0cc03e4b.js"><link rel="prefetch" href="/assets/js/179.072066de.js"><link rel="prefetch" href="/assets/js/18.679e1c4b.js"><link rel="prefetch" href="/assets/js/180.33f686cd.js"><link rel="prefetch" href="/assets/js/181.a5b2d116.js"><link rel="prefetch" href="/assets/js/182.bc0e32f7.js"><link rel="prefetch" href="/assets/js/183.4af27dba.js"><link rel="prefetch" href="/assets/js/184.e128cd0e.js"><link rel="prefetch" href="/assets/js/185.acac94c9.js"><link rel="prefetch" href="/assets/js/186.7c9c7187.js"><link rel="prefetch" href="/assets/js/187.eeb6c069.js"><link rel="prefetch" href="/assets/js/188.399f7a36.js"><link rel="prefetch" href="/assets/js/189.bb284f99.js"><link rel="prefetch" href="/assets/js/19.c3df06ff.js"><link rel="prefetch" href="/assets/js/190.a8203c7b.js"><link rel="prefetch" href="/assets/js/191.88fce7ad.js"><link rel="prefetch" href="/assets/js/192.7b7d7618.js"><link rel="prefetch" href="/assets/js/193.0e4488fb.js"><link rel="prefetch" href="/assets/js/194.1d37c8b9.js"><link rel="prefetch" href="/assets/js/195.44e9ddb7.js"><link rel="prefetch" href="/assets/js/196.1e080b70.js"><link rel="prefetch" href="/assets/js/197.c3ba1d50.js"><link rel="prefetch" href="/assets/js/198.c1610085.js"><link rel="prefetch" href="/assets/js/199.bace1668.js"><link rel="prefetch" href="/assets/js/20.bd3e067c.js"><link rel="prefetch" href="/assets/js/200.e202d26f.js"><link rel="prefetch" href="/assets/js/201.9348c033.js"><link rel="prefetch" href="/assets/js/202.65a7101b.js"><link rel="prefetch" href="/assets/js/203.d2c8e25f.js"><link rel="prefetch" href="/assets/js/204.2ba7d16f.js"><link rel="prefetch" href="/assets/js/205.d38fcb78.js"><link rel="prefetch" href="/assets/js/206.7752115f.js"><link rel="prefetch" href="/assets/js/207.ffb7957b.js"><link rel="prefetch" href="/assets/js/208.66fec794.js"><link rel="prefetch" href="/assets/js/209.25b274e2.js"><link rel="prefetch" href="/assets/js/21.2524824e.js"><link rel="prefetch" href="/assets/js/210.28fe3c1f.js"><link rel="prefetch" href="/assets/js/211.305660ff.js"><link rel="prefetch" href="/assets/js/212.b67f0165.js"><link rel="prefetch" href="/assets/js/213.6406089b.js"><link rel="prefetch" href="/assets/js/214.cde121b8.js"><link rel="prefetch" href="/assets/js/215.5b99cb24.js"><link rel="prefetch" href="/assets/js/216.858636a2.js"><link rel="prefetch" href="/assets/js/217.c46337d4.js"><link rel="prefetch" href="/assets/js/218.44489868.js"><link rel="prefetch" href="/assets/js/219.fcd0a298.js"><link rel="prefetch" href="/assets/js/22.c140d896.js"><link rel="prefetch" href="/assets/js/220.3a57f6e0.js"><link rel="prefetch" href="/assets/js/221.ecfa4b29.js"><link rel="prefetch" href="/assets/js/222.1c0f35d1.js"><link rel="prefetch" href="/assets/js/223.c7dca7ac.js"><link rel="prefetch" href="/assets/js/224.b7626b65.js"><link rel="prefetch" href="/assets/js/225.b729cf1e.js"><link rel="prefetch" href="/assets/js/226.05c5473d.js"><link rel="prefetch" href="/assets/js/227.91e74f3b.js"><link rel="prefetch" href="/assets/js/228.adb127d4.js"><link rel="prefetch" href="/assets/js/229.80ec8a1a.js"><link rel="prefetch" href="/assets/js/23.e3364cbe.js"><link rel="prefetch" href="/assets/js/230.0115051e.js"><link rel="prefetch" href="/assets/js/231.f329be38.js"><link rel="prefetch" href="/assets/js/232.78756dd7.js"><link rel="prefetch" href="/assets/js/233.8b606804.js"><link rel="prefetch" href="/assets/js/234.d77ff187.js"><link rel="prefetch" href="/assets/js/235.8f6a9b70.js"><link rel="prefetch" href="/assets/js/236.d9898f12.js"><link rel="prefetch" href="/assets/js/237.8d4b828f.js"><link rel="prefetch" href="/assets/js/238.1d71706c.js"><link rel="prefetch" href="/assets/js/239.c6f9604f.js"><link rel="prefetch" href="/assets/js/24.849008f7.js"><link rel="prefetch" href="/assets/js/240.0a508acb.js"><link rel="prefetch" href="/assets/js/241.0a74787b.js"><link rel="prefetch" href="/assets/js/242.86a7ef99.js"><link rel="prefetch" href="/assets/js/243.4924c2de.js"><link rel="prefetch" href="/assets/js/244.3c683ef9.js"><link rel="prefetch" href="/assets/js/245.8c9f1e44.js"><link rel="prefetch" href="/assets/js/246.fc5d2c03.js"><link rel="prefetch" href="/assets/js/247.74303e39.js"><link rel="prefetch" href="/assets/js/248.f4fdd84f.js"><link rel="prefetch" href="/assets/js/249.b95dcd81.js"><link rel="prefetch" href="/assets/js/25.af9e19cb.js"><link rel="prefetch" href="/assets/js/251.7e035ad8.js"><link rel="prefetch" href="/assets/js/252.52b88669.js"><link rel="prefetch" href="/assets/js/253.8e426414.js"><link rel="prefetch" href="/assets/js/254.1c79a0ff.js"><link rel="prefetch" href="/assets/js/255.a83f3566.js"><link rel="prefetch" href="/assets/js/256.28628506.js"><link rel="prefetch" href="/assets/js/257.deedf7ab.js"><link rel="prefetch" href="/assets/js/258.53ab06d1.js"><link rel="prefetch" href="/assets/js/259.a8115ae3.js"><link rel="prefetch" href="/assets/js/26.355cb109.js"><link rel="prefetch" href="/assets/js/260.0edd57b4.js"><link rel="prefetch" href="/assets/js/261.75c0cad1.js"><link rel="prefetch" href="/assets/js/262.29be1dd0.js"><link rel="prefetch" href="/assets/js/263.e39f501e.js"><link rel="prefetch" href="/assets/js/264.df23c72d.js"><link rel="prefetch" href="/assets/js/265.330233bb.js"><link rel="prefetch" href="/assets/js/266.edec9f04.js"><link rel="prefetch" href="/assets/js/267.fd6096d7.js"><link rel="prefetch" href="/assets/js/268.0cd40d5c.js"><link rel="prefetch" href="/assets/js/269.814f292a.js"><link rel="prefetch" href="/assets/js/27.f5369702.js"><link rel="prefetch" href="/assets/js/28.5edc9559.js"><link rel="prefetch" href="/assets/js/29.3c4e22e4.js"><link rel="prefetch" href="/assets/js/3.12186190.js"><link rel="prefetch" href="/assets/js/30.7dcf549a.js"><link rel="prefetch" href="/assets/js/31.bb36e762.js"><link rel="prefetch" href="/assets/js/32.9a5037aa.js"><link rel="prefetch" href="/assets/js/33.41cad49e.js"><link rel="prefetch" href="/assets/js/34.54ab464f.js"><link rel="prefetch" href="/assets/js/35.38240c18.js"><link rel="prefetch" href="/assets/js/36.4e4025ea.js"><link rel="prefetch" href="/assets/js/37.e9441fd8.js"><link rel="prefetch" href="/assets/js/38.7f5f0017.js"><link rel="prefetch" href="/assets/js/39.70b5d73e.js"><link rel="prefetch" href="/assets/js/4.688aea8c.js"><link rel="prefetch" href="/assets/js/40.076819f4.js"><link rel="prefetch" href="/assets/js/41.67608cc1.js"><link rel="prefetch" href="/assets/js/42.af9b9aec.js"><link rel="prefetch" href="/assets/js/43.c092f97c.js"><link rel="prefetch" href="/assets/js/44.23d3d65c.js"><link rel="prefetch" href="/assets/js/45.a6bd6e74.js"><link rel="prefetch" href="/assets/js/46.964042e4.js"><link rel="prefetch" href="/assets/js/47.1ac801fb.js"><link rel="prefetch" href="/assets/js/48.ec620f97.js"><link rel="prefetch" href="/assets/js/49.efa4ffbd.js"><link rel="prefetch" href="/assets/js/5.eb1d7ab1.js"><link rel="prefetch" href="/assets/js/50.8e2f4aa1.js"><link rel="prefetch" href="/assets/js/51.c3ea15e3.js"><link rel="prefetch" href="/assets/js/52.586b35af.js"><link rel="prefetch" href="/assets/js/53.236275ec.js"><link rel="prefetch" href="/assets/js/54.981e70fa.js"><link rel="prefetch" href="/assets/js/55.d8be2d4f.js"><link rel="prefetch" href="/assets/js/56.a303289f.js"><link rel="prefetch" href="/assets/js/57.f121e9da.js"><link rel="prefetch" href="/assets/js/58.7abebc4b.js"><link rel="prefetch" href="/assets/js/59.bc504e29.js"><link rel="prefetch" href="/assets/js/6.c534d3b8.js"><link rel="prefetch" href="/assets/js/60.15c00f70.js"><link rel="prefetch" href="/assets/js/61.338cea0a.js"><link rel="prefetch" href="/assets/js/62.7c20cc40.js"><link rel="prefetch" href="/assets/js/63.6433da20.js"><link rel="prefetch" href="/assets/js/64.290f25ce.js"><link rel="prefetch" href="/assets/js/65.25c56edf.js"><link rel="prefetch" href="/assets/js/66.9c8696b9.js"><link rel="prefetch" href="/assets/js/67.6bd3458f.js"><link rel="prefetch" href="/assets/js/68.4e400421.js"><link rel="prefetch" href="/assets/js/69.b19325a9.js"><link rel="prefetch" href="/assets/js/7.aafa7ae1.js"><link rel="prefetch" href="/assets/js/70.d8b0f01e.js"><link rel="prefetch" href="/assets/js/71.43b0fc82.js"><link rel="prefetch" href="/assets/js/72.3e2769d0.js"><link rel="prefetch" href="/assets/js/73.0ffb5d8c.js"><link rel="prefetch" href="/assets/js/74.a012e667.js"><link rel="prefetch" href="/assets/js/75.1eba587a.js"><link rel="prefetch" href="/assets/js/76.3a7d9762.js"><link rel="prefetch" href="/assets/js/77.753fa003.js"><link rel="prefetch" href="/assets/js/78.c81459bc.js"><link rel="prefetch" href="/assets/js/79.87d39576.js"><link rel="prefetch" href="/assets/js/8.8e731cc1.js"><link rel="prefetch" href="/assets/js/80.442d184f.js"><link rel="prefetch" href="/assets/js/81.eb2dc053.js"><link rel="prefetch" href="/assets/js/82.8e06f545.js"><link rel="prefetch" href="/assets/js/83.57b2be19.js"><link rel="prefetch" href="/assets/js/84.66f4838c.js"><link rel="prefetch" href="/assets/js/85.c16c6217.js"><link rel="prefetch" href="/assets/js/86.36dc3b10.js"><link rel="prefetch" href="/assets/js/87.4a7e9da8.js"><link rel="prefetch" href="/assets/js/88.66151b5b.js"><link rel="prefetch" href="/assets/js/89.dee42034.js"><link rel="prefetch" href="/assets/js/9.9e740009.js"><link rel="prefetch" href="/assets/js/90.32d3f648.js"><link rel="prefetch" href="/assets/js/91.cd601f08.js"><link rel="prefetch" href="/assets/js/92.23c11ac0.js"><link rel="prefetch" href="/assets/js/93.c2d49b31.js"><link rel="prefetch" href="/assets/js/94.c44f2adf.js"><link rel="prefetch" href="/assets/js/95.283c2deb.js"><link rel="prefetch" href="/assets/js/96.ca9f449a.js"><link rel="prefetch" href="/assets/js/97.808b88cb.js"><link rel="prefetch" href="/assets/js/98.e408d8ca.js"><link rel="prefetch" href="/assets/js/99.14a64144.js">
    <link rel="stylesheet" href="/assets/css/0.styles.74fd5345.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/en/" class="home-link router-link-active"><img src="/hadoop.jpeg" alt="Hadoop Chinese Website" class="logo"> <span class="site-name can-hide">Hadoop Chinese Website</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Index</a></div><div class="nav-item"><a href="/docs/releases/" class="nav-link">Download</a></div><div class="nav-item"><a href="/docs/" class="nav-link">Documentation</a></div><div class="nav-item"><a href="/docs/awesome/" class="nav-link">Awesome</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/hadoop-yarn/hadoop-yarn-site/TimelineServiceV2.html" class="nav-link">简体中文</a></li><li class="dropdown-item"><!----> <a href="/en/docs/hadoop-yarn/hadoop-yarn-site/TimelineServiceV2.html" class="nav-link router-link-exact-active router-link-active">English</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Index</a></div><div class="nav-item"><a href="/docs/releases/" class="nav-link">Download</a></div><div class="nav-item"><a href="/docs/" class="nav-link">Documentation</a></div><div class="nav-item"><a href="/docs/awesome/" class="nav-link">Awesome</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/hadoop-yarn/hadoop-yarn-site/TimelineServiceV2.html" class="nav-link">简体中文</a></li><li class="dropdown-item"><!----> <a href="/en/docs/hadoop-yarn/hadoop-yarn-site/TimelineServiceV2.html" class="nav-link router-link-exact-active router-link-active">English</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>General</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/" class="sidebar-link">Overview</a></li><li><a href="/docs/hadoop-project-dist/hadoop-common/SingleCluster.html" class="sidebar-link">Single Node Setup</a></li><li><a href="/docs/hadoop-project-dist/hadoop-common/ClusterSetup.html" class="sidebar-link">Cluster Setup</a></li><li><a href="/docs/hadoop-project-dist/hadoop-common/CommandsManual.html" class="sidebar-link">Commands Reference</a></li><li><a href="/docs/hadoop-project-dist/hadoop-common/FileSystemShell.html" class="sidebar-link">FileSystem Shell</a></li><li><a href="/docs/hadoop-project-dist/hadoop-common/Compatibility.html" class="sidebar-link">Compatibility Specification</a></li><li><a href="/docs/hadoop-project-dist/hadoop-common/DownstreamDev.html" class="sidebar-link">Downstream Developer's Guide</a></li><li><a href="/docs/hadoop-project-dist/hadoop-common/AdminCompatibilityGuide.html" class="sidebar-link">Admin Compatibility Guide</a></li><li><a href="/docs/hadoop-project-dist/hadoop-common/InterfaceClassification.html" class="sidebar-link">Interface Classification</a></li><li><a href="/docs/hadoop-project-dist/hadoop-common/filesystem/" class="sidebar-link">FileSystem Specification</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Common</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HDFS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>MapReduce</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>MapReduce REST APIs</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>YARN</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>YARN REST APIs</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>YARN Service</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Submarine</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Hadoop Compatible File Systems</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Auth</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Tools</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Reference</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Configuration</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="the-yarn-timeline-service-v-2"><a href="#the-yarn-timeline-service-v-2" class="header-anchor">#</a> The YARN Timeline Service v.2</h1> <h2 id="overview"><a href="#overview" class="header-anchor">#</a> Overview</h2> <h3 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h3> <p>YARN Timeline Service v.2 is the next major iteration of Timeline Server, following v.1 and v.1.5. V.2 is created to address two major challenges of v.1.</p> <h4 id="scalability"><a href="#scalability" class="header-anchor">#</a> Scalability</h4> <p>V.1 is limited to a single instance of writer/reader and storage, and does not scale well beyond small clusters. V.2 uses a more scalable distributed writer architecture and a scalable backend storage.</p> <p>YARN Timeline Service v.2 separates the collection (writes) of data from serving (reads) of data. It uses distributed collectors, essentially one collector for each YARN application. The readers are separate instances that are dedicated to serving queries via REST API.</p> <p>YARN Timeline Service v.2 chooses Apache HBase as the primary backing storage, as Apache HBase scales well to a large size while maintaining good response times for reads and writes.</p> <h4 id="usability-improvements"><a href="#usability-improvements" class="header-anchor">#</a> Usability improvements</h4> <p>In many cases, users are interested in information at the level of “flows” or logical groups of YARN applications. It is much more common to launch a set or series of YARN applications to complete a logical application. Timeline Service v.2 supports the notion of flows explicitly. In addition, it supports aggregating metrics at the flow level.</p> <p>Also, information such as configuration and metrics is treated and supported as first-class citizens.</p> <p>The following diagrams illustrates the relationship between different YARN entities modelling flows.</p> <img src="/images/flow_hierarchy.png" alt="Flow Hierarchy"> <h3 id="architecture"><a href="#architecture" class="header-anchor">#</a> Architecture</h3> <p>YARN Timeline Service v.2 uses a set of collectors (writers) to write data to the backend storage. The collectors are distributed and co-located with the application masters to which they are dedicated. All data that belong to that application are sent to the application level timeline collectors with the exception of the resource manager timeline collector.</p> <p>For a given application, the application master can write data for the application to the co-located timeline collectors (which is an NM auxiliary service in this release). In addition, node managers of other nodes that are running the containers for the application also write data to the timeline collector on the node that is running the application master.</p> <p>The resource manager also maintains its own timeline collector. It emits only YARN-generic lifecycle events to keep its volume of writes reasonable.</p> <p>The timeline readers are separate daemons separate from the timeline collectors, and they are dedicated to serving queries via REST API.</p> <p>The following diagram illustrates the design at a high level.</p> <img src="/images/timeline_v2.jpg" alt="Timeline Service v.2  architecture"> <h3 id="current-status-and-future-plans"><a href="#current-status-and-future-plans" class="header-anchor">#</a> Current Status and Future Plans</h3> <p>A complete end-to-end flow of writes and reads is functional, with Apache HBase as the backend. You should be able to start generating data. When enabled, all YARN-generic events are published as well as YARN system metrics such as CPU and memory. Furthermore, some applications including Distributed Shell and MapReduce can write per-framework data to YARN Timeline Service v.2.</p> <p>The basic mode of accessing data is via REST. The REST API comes with a good number of useful and flexible query patterns (see below for more information). YARN Client has been integrated with ATSv2. This enables fetching application/attempt/container report from TimelineReader if details are not present in ResouceManager.</p> <p>The collectors (writers) are currently embedded in the node managers as auxiliary services. The resource manager also has its dedicated in-process collector. The reader is currently a single instance. Currently, it is not possible to write to Timeline Service outside the context of a YARN application (i.e. no off-cluster client).</p> <p>Kerberos Authentication is supported end to end. All communication to HBase can be kerberized. Refer Security Configuration for configs. Support for simple authorization has been added in terms of a configurable whitelist of users and groups who can read timeline data. Cluster admins are allowed by default to read timeline data.</p> <p>When YARN Timeline Service v.2 is disabled, one can expect no functional or performance impact on any other existing functionality.</p> <p>Road map includes</p> <ul><li>More robust storage fault tolerance.</li> <li>Support for off-cluster clients</li> <li>Support for entity ACLs</li> <li>Offline (time-based periodic) aggregation for flows, users, and queues for reporting and analysis</li> <li>Migration and compatibility with v.1</li></ul> <h2 id="deployment"><a href="#deployment" class="header-anchor">#</a> Deployment</h2> <h3 id="configurations"><a href="#configurations" class="header-anchor">#</a> Configurations</h3> <p>New configuration parameters that are introduced with v.2 are marked bold.</p> <h4 id="basic-configuration"><a href="#basic-configuration" class="header-anchor">#</a> Basic configuration</h4> <table><thead><tr><th>Configuration Property</th> <th>Description</th></tr></thead> <tbody><tr><td>yarn.timeline-service.enabled</td> <td>Indicate to clients whether Timeline service is enabled or not. If enabled, the TimelineClient library used by applications will post entities and events to the Timeline server. Defaults to false.</td></tr> <tr><td>yarn.timeline-service.version</td> <td>Indicate what is the current version of the running timeline service. For example, if “yarn.timeline-service.version” is 1.5, and “yarn.timeline-service.enabled” is true, it means the cluster will and must bring up the timeline service v.1.5 (and nothing else). On the client side, if the client uses the same version of timeline service, it must succeed. If the client chooses to use a smaller version in spite of this, then depending on how robust the compatibility story is between versions, the results may vary. Defaults to 1.0f.</td></tr> <tr><td>yarn.timeline-service.writer.class</td> <td>The class for the backend storage writer. Defaults to HBase storage writer.</td></tr> <tr><td>yarn.timeline-service.reader.class</td> <td>The class for the backend storage reader. Defaults to HBase storage reader.</td></tr> <tr><td>yarn.system-metrics-publisher.enabled</td> <td>The setting that controls whether yarn system metrics is published on the Timeline service or not by RM And NM. Defaults to false.</td></tr> <tr><td>yarn.timeline-service.schema.prefix</td> <td>The schema prefix for hbase tables. Defaults to “prod.”.</td></tr></tbody></table> <h4 id="advanced-configuration"><a href="#advanced-configuration" class="header-anchor">#</a> Advanced configuration</h4> <table><thead><tr><th>Configuration Property</th> <th>Description</th></tr></thead> <tbody><tr><td>yarn.timeline-service.hostname</td> <td>The hostname of the Timeline service web application. Defaults to 0.0.0.0</td></tr> <tr><td>yarn.timeline-service.reader.webapp.address</td> <td>The http address of the Timeline Reader web application. Defaults to ${yarn.timeline-service.hostname}:8188.</td></tr> <tr><td>yarn.timeline-service.reader.webapp.https.address</td> <td>The https address of the Timeline Reader web application. Defaults to ${yarn.timeline-service.hostname}:8190.</td></tr> <tr><td>yarn.timeline-service.reader.bind-host</td> <td>The actual address the timeline reader will bind to. If this optional address is set, reader server will bind to this address and the port specified in yarn.timeline-service.reader.webapp.address. This is most useful for making the service listen on all interfaces by setting to 0.0.0.0.</td></tr> <tr><td>yarn.timeline-service.hbase.configuration.file</td> <td>Optional URL to an hbase-site.xml configuration file to be used to connect to the timeline-service hbase cluster. If empty or not specified, then the HBase configuration will be loaded from the classpath. When specified the values in the specified configuration file will override those from the ones that are present on the classpath. Defaults to null.</td></tr> <tr><td>yarn.timeline-service.writer.flush-interval-seconds</td> <td>The setting that controls how often the timeline collector flushes the timeline writer. Defaults to 60.</td></tr> <tr><td>yarn.timeline-service.app-collector.linger-period.ms</td> <td>Time period till which the application collector will be alive in NM, after the application master container finishes. Defaults to 60000 (60 seconds).</td></tr> <tr><td>yarn.timeline-service.timeline-client.number-of-async-entities-to-merge</td> <td>Time line V2 client tries to merge these many number of async entities (if available) and then call the REST ATS V2 API to submit. Defaults to 10.</td></tr> <tr><td>yarn.timeline-service.hbase.coprocessor.app-final-value-retention-milliseconds</td> <td>The setting that controls how long the final value of a metric of a completed app is retained before merging into the flow sum. Defaults to 259200000 (3 days). This should be set in the HBase cluster.</td></tr> <tr><td>yarn.rm.system-metrics-publisher.emit-container-events</td> <td>The setting that controls whether yarn container metrics is published to the timeline server or not by RM. This configuration setting is for ATS V2. Defaults to false.</td></tr> <tr><td>yarn.nodemanager.emit-container-events</td> <td>The setting that controls whether yarn container metrics is published to the timeline server or not by NM. This configuration setting is for ATS V2. Defaults to true.</td></tr></tbody></table> <h4 id="security-configuration"><a href="#security-configuration" class="header-anchor">#</a> Security Configuration</h4> <p>Security can be enabled by setting yarn.timeline-service.http-authentication.type to kerberos, after which the following configuration options are available:</p> <table><thead><tr><th>Configuration Property</th> <th>Description</th></tr></thead> <tbody><tr><td>yarn.timeline-service.http-authentication.type</td> <td>Defines authentication used for the timeline server(collector/reader) HTTP endpoint. Supported values are: simple / kerberos / #AUTHENTICATION_HANDLER_CLASSNAME#. Defaults to simple.</td></tr> <tr><td>yarn.timeline-service.http-authentication.simple.anonymous.allowed</td> <td>Indicates if anonymous requests are allowed by the timeline server when using ‘simple’ authentication. Defaults to true.</td></tr> <tr><td>yarn.timeline-service.http-authentication.kerberos.principal</td> <td>The Kerberos principal to be used for the Timeline Server(Collector/Reader) HTTP endpoint.</td></tr> <tr><td>yarn.timeline-service.http-authentication.kerberos.keytab</td> <td>The Kerberos keytab to be used for the Timeline Server(Collector/Reader) HTTP endpoint..</td></tr> <tr><td>yarn.timeline-service.principal</td> <td>The Kerberos principal for the timeline reader. NM principal would be used for timeline collector as it runs as an auxiliary service inside NM.</td></tr> <tr><td>yarn.timeline-service.keytab</td> <td>The Kerberos keytab for the timeline reader. NM keytab would be used for timeline collector as it runs as an auxiliary service inside NM.</td></tr> <tr><td>yarn.timeline-service.delegation.key.update-interval</td> <td>Defaults to 86400000 (1 day).</td></tr> <tr><td>yarn.timeline-service.delegation.token.renew-interval</td> <td>Defaults to 86400000 (1 day).</td></tr> <tr><td>yarn.timeline-service.delegation.token.max-lifetime</td> <td>Defaults to 604800000 (7 days).</td></tr> <tr><td>yarn.timeline-service.read.authentication.enabled</td> <td>Enables or disables authorization checks for reading timeline service v2 data. Default is false which is disabled.</td></tr> <tr><td>yarn.timeline-service.read.allowed.users</td> <td>Comma separated list of user, followed by space, then comma separated list of groups. It will allow this list of users and groups to read the data and reject everyone else. Default value is set to none. If authorization is enabled, then this configuration is mandatory.</td></tr> <tr><td>yarn.webapp.filter-entity-list-by-user</td> <td>Default is false. If set true and yarn.timeline-service.read.authentication.enabled is disabled, then listing of entities restricted to remote user entities only. It is YARN common configuration for listing APIs. Using this configuration TimelineReader authorize caller UGI with entity owner. If does not match, those entities will be removed from response.</td></tr></tbody></table> <h4 id="enabling-cors-support"><a href="#enabling-cors-support" class="header-anchor">#</a> Enabling CORS support</h4> <p>To enable cross-origin support (CORS) for the Timeline Service v.2, please set the following configuration parameters:</p> <p>In yarn-site.xml, set yarn.timeline-service.http-cross-origin.enabled to true.</p> <p>In core-site.xml, add org.apache.hadoop.security.HttpCrossOriginFilterInitializer to hadoop.http.filter.initializers.</p> <p>For more configurations used for cross-origin support, refer to <a href="/en/docs/hadoop-project-dist/hadoop-common/HttpAuthentication.html#CORS">HttpAuthentication</a>. Please note that yarn.timeline-service.http-cross-origin.enabled, if set to true, overrides hadoop.http.cross-origin.enabled.</p> <h3 id="enabling-timeline-service-v-2"><a href="#enabling-timeline-service-v-2" class="header-anchor">#</a> Enabling Timeline Service v.2</h3> <h4 id="preparing-apache-hbase-cluster-for-storage"><a href="#preparing-apache-hbase-cluster-for-storage" class="header-anchor">#</a> Preparing Apache HBase cluster for storage</h4> <p>There are a few steps to be done for preparing the storage for Timeline Service v.2:</p> <p>Step 1) Set up the HBase cluster</p> <p>Step 2) Enable the coprocessor</p> <p>Step 3) Create the schema for Timeline Service v.2</p> <p>Each step is explained in more detail below.</p> <h5 id="step-1-set-up-the-hbase-cluster"><a href="#step-1-set-up-the-hbase-cluster" class="header-anchor">#</a> Step 1) Set up the HBase cluster</h5> <p>The first part is to set up or pick an Apache HBase cluster to use as the storage cluster. The supported versions of Apache HBase are 1.2.6 (default) and 2.0.0-beta1. The 1.0.x versions do not work with Timeline Service v.2. By default, Hadoop releases are built with HBase 1.2.6. To use HBase 2.0.0-beta1, build from source with option -Dhbase.profile=2.0</p> <p>HBase has different deployment modes. Refer to the HBase book for understanding them and pick a mode that is suitable for your setup. (<a href="http://hbase.apache.org/book.html#standalone_dist" target="_blank" rel="noopener noreferrer">http://hbase.apache.org/book.html#standalone_dist<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>)</p> <h5 id="simple-deployment-for-hbase"><a href="#simple-deployment-for-hbase" class="header-anchor">#</a> Simple deployment for HBase</h5> <p>If you are intent on a simple deploy profile for the Apache HBase cluster where the data loading is light but the data needs to persist across node comings and goings, you could consider the “Standalone HBase over HDFS” deploy mode.</p> <p>This is a useful variation on the standalone HBase setup and has all HBase daemons running inside one JVM but rather than persisting to the local filesystem, it persists to an HDFS instance. Writing to HDFS where data is replicated ensures that data is persisted across node comings and goings. To configure this standalone variant, edit your hbase-site.xml setting the hbase.rootdir to point at a directory in your HDFS instance but then set hbase.cluster.distributed to false. For example:</p> <pre><code>&lt;configuration&gt;
  &lt;property&gt;
    &lt;name&gt;hbase.rootdir&lt;/name&gt;
    &lt;value&gt;hdfs://namenode.example.org:8020/hbase&lt;/value&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;hbase.cluster.distributed&lt;/name&gt;
    &lt;value&gt;false&lt;/value&gt;
  &lt;/property&gt;
&lt;/configuration&gt;
</code></pre> <p>For more details on this mode, refer to <a href="http://hbase.apache.org/book.html#standalone.over.hdfs" target="_blank" rel="noopener noreferrer">http://hbase.apache.org/book.html#standalone.over.hdfs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> .</p> <p>Once you have an Apache HBase cluster ready to use, perform the following steps.</p> <h5 id="step-2-enable-the-coprocessor"><a href="#step-2-enable-the-coprocessor" class="header-anchor">#</a> Step 2) Enable the coprocessor</h5> <p>In this version, the coprocessor is loaded dynamically (table coprocessor for the flowrun table).</p> <p>Copy the timeline service jar to HDFS from where HBase can load it. It is needed for the flowrun table creation in the schema creator. The default HDFS location is /hbase/coprocessor. For example,</p> <pre><code>hadoop fs -mkdir /hbase/coprocessor
hadoop fs -put hadoop-yarn-server-timelineservice-hbase-coprocessor-3.2.0-SNAPSHOT.jar
       /hbase/coprocessor/hadoop-yarn-server-timelineservice.jar
</code></pre> <p>If you want to place the jar at a different location on hdfs, there also exists a yarn configuration setting called yarn.timeline-service.hbase.coprocessor.jar.hdfs.location. For example,</p> <pre><code>&lt;property&gt;
  &lt;name&gt;yarn.timeline-service.hbase.coprocessor.jar.hdfs.location&lt;/name&gt;
  &lt;value&gt;/custom/hdfs/path/jarName&lt;/value&gt;
&lt;/property&gt;
</code></pre> <h5 id="step-3-create-the-timeline-service-schema"><a href="#step-3-create-the-timeline-service-schema" class="header-anchor">#</a> Step 3) Create the timeline service schema</h5> <p>Finally, run the schema creator tool to create the necessary tables:</p> <pre><code>bin/hadoop org.apache.hadoop.yarn.server.timelineservice.storage.TimelineSchemaCreator -create
</code></pre> <p>The TimelineSchemaCreator tool supports a few options that may come handy especially when you are testing. For example, you can use -skipExistingTable (-s for short) to skip existing tables and continue to create other tables rather than failing the schema creation. By default, the tables will have a schema prefix of “prod.”. When no option or ‘-help’ (‘-h’ for short) is provided, the command usage is printed. The options (-entityTableName, -appToflowTableName, -applicationTableName, -subApplicationTableName) will help to override the default table names. On using custom table names, The below corresponding configs with custom table name has to be set in hbase-site.xml configured at yarn.timeline-service.hbase.configuration.file.</p> <pre><code>yarn.timeline-service.app-flow.table.name
yarn.timeline-service.entity.table.name
yarn.timeline-service.application.table.name
yarn.timeline-service.subapplication.table.name
yarn.timeline-service.flowactivity.table.name
yarn.timeline-service.flowrun.table.name
yarn.timeline-service.domain.table.name
</code></pre> <h4 id="enabling-timeline-service-v-2-2"><a href="#enabling-timeline-service-v-2-2" class="header-anchor">#</a> Enabling Timeline Service v.2</h4> <p>Following are the basic configurations to start Timeline service v.2:</p> <pre><code>&lt;property&gt;
  &lt;name&gt;yarn.timeline-service.version&lt;/name&gt;
  &lt;value&gt;2.0f&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.timeline-service.enabled&lt;/name&gt;
  &lt;value&gt;true&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;
  &lt;value&gt;mapreduce_shuffle,timeline_collector&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.nodemanager.aux-services.timeline_collector.class&lt;/name&gt;
  &lt;value&gt;org.apache.hadoop.yarn.server.timelineservice.collector.PerNodeTimelineCollectorsAuxService&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;description&gt;The setting that controls whether yarn system metrics is
  published on the Timeline service or not by RM And NM.&lt;/description&gt;
  &lt;name&gt;yarn.system-metrics-publisher.enabled&lt;/name&gt;
  &lt;value&gt;true&lt;/value&gt;
&lt;/property&gt;
</code></pre> <p>In addition, you may want to set the YARN cluster name to a reasonably unique value in case you are using multiple clusters to store data in the same Apache HBase storage:</p> <pre><code>&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.cluster-id&lt;/name&gt;
  &lt;value&gt;my_research_test_cluster&lt;/value&gt;
&lt;/property&gt;
</code></pre> <p>Also, add the hbase-site.xml configuration file to the client Hadoop cluster configuration so that it can write data to the Apache HBase cluster you are using, or set yarn.timeline-service.hbase.configuration.file to the file URL pointing to hbase-site.xml for the same. For example:</p> <pre><code>&lt;property&gt;
  &lt;description&gt; Optional URL to an hbase-site.xml configuration file to be
  used to connect to the timeline-service hbase cluster. If empty or not
  specified, then the HBase configuration will be loaded from the classpath.
  When specified the values in the specified configuration file will override
  those from the ones that are present on the classpath.
  &lt;/description&gt;
  &lt;name&gt;yarn.timeline-service.hbase.configuration.file&lt;/name&gt;
  &lt;value&gt;file:/etc/hbase/hbase-ats-dc1/hbase-site.xml&lt;/value&gt;
&lt;/property&gt;
</code></pre> <p>To configure both Timeline Service 1.5 and v.2, add the following property</p> <pre><code>&lt;property&gt;
  &lt;name&gt;yarn.timeline-service.versions&lt;/name&gt;
  &lt;value&gt;1.5f,2.0f&lt;/value&gt;
&lt;/property&gt;
</code></pre> <p>If the above is not configured, then it defaults to the version set in yarn.timeline-service.version</p> <h4 id="running-timeline-service-v-2"><a href="#running-timeline-service-v-2" class="header-anchor">#</a> Running Timeline Service v.2</h4> <p>Restart the resource manager as well as the node managers to pick up the new configuration. The collectors start within the resource manager and the node managers in an embedded manner.</p> <p>The Timeline Service reader is a separate YARN daemon, and it can be started using the following syntax:</p> <pre><code>$ yarn-daemon.sh start timelinereader
</code></pre> <h4 id="enabling-mapreduce-to-write-to-timeline-service-v-2"><a href="#enabling-mapreduce-to-write-to-timeline-service-v-2" class="header-anchor">#</a> Enabling MapReduce to write to Timeline Service v.2</h4> <p>To write MapReduce framework data to Timeline Service v.2, enable the following configuration in mapred-site.xml:</p> <pre><code>&lt;property&gt;
  &lt;name&gt;mapreduce.job.emit-timeline-data&lt;/name&gt;
  &lt;value&gt;true&lt;/value&gt;
&lt;/property&gt;
</code></pre> <h3 id="upgrade-from-alpha1-to-ga"><a href="#upgrade-from-alpha1-to-ga" class="header-anchor">#</a> Upgrade from alpha1 to GA</h3> <p>If you are currently running Timeline Service v2 alpha1 version, we recommend the following:</p> <ul><li><p>Clear existing data in tables (truncate tables) since the row key for AppToFlow has changed.</p></li> <li><p>The coprocessor is now a dynamically loaded table level coprocessor in GA. We recommend dropping the table, replacing the coprocessor jar on hdfs with the GA one, restarting the Region servers and recreating the flowrun table.</p></li></ul> <h3 id="publishing-application-specific-data"><a href="#publishing-application-specific-data" class="header-anchor">#</a> Publishing application specific data</h3> <p>This section is for YARN application developers that want to integrate with Timeline Service v.2.</p> <p>Developers need to use the TimelineV2Client API to publish per-framework data to the Timeline Service v.2. The entity/object API for v.2 is different than v.1 as the object model is significantly changed. The v.2 timeline entity class is org.apache.hadoop.yarn.api.records.timelineservice.TimelineEntity.</p> <p>Timeline Service v.2 putEntities methods come in 2 varieties: putEntities and putEntitiesAsync. The former is a blocking operation which must be used for writing more critical data (e.g. lifecycle events). The latter is a non-blocking operation. Note that neither has a return value.</p> <p>Creating a TimelineV2Client involves passing in the application id to the static method TimelineV2Client.createTimelineClient.</p> <p>For example:</p> <pre><code>// Create and start the Timeline client v.2
TimelineV2Client timelineClient =
    TimelineV2Client.createTimelineClient(appId);
timelineClient.init(conf);
timelineClient.start();

try {
  TimelineEntity myEntity = new TimelineEntity();
  myEntity.setType(&quot;MY_APPLICATION&quot;);
  myEntity.setId(&quot;MyApp1&quot;);
  // Compose other entity info

  // Blocking write
  timelineClient.putEntities(myEntity);

  TimelineEntity myEntity2 = new TimelineEntity();
  // Compose other info

  // Non-blocking write
  timelineClient.putEntitiesAsync(myEntity2);

} catch (IOException | YarnException e) {
  // Handle the exception
} finally {
  // Stop the Timeline client
  timelineClient.stop();
}
</code></pre> <p>As evidenced above, you need to specify the YARN application id to be able to write to the Timeline Service v.2. Note that currently you need to be on the cluster to be able to write to the Timeline Service. For example, an application master or code in the container can write to the Timeline Service, while an off-cluster MapReduce job submitter cannot.</p> <p>After creating the timeline v2 client, user also needs to set the timeline collector info which contains the collector address and collector token(only in secure mode) for the application. If AMRMClient is used then by registering the timeline client by calling AMRMClient#registerTimelineV2Client is sufficient.</p> <pre><code>amRMClient.registerTimelineV2Client(timelineClient);
</code></pre> <p>Else address needs to be retrieved from the AM allocate response and need to be set in timeline client explicitly.</p> <pre><code>timelineClient.setTimelineCollectorInfo(response.getCollectorInfo());
</code></pre> <p>You can create and publish your own entities, events, and metrics as with previous versions.</p> <p>TimelineEntity objects have the following fields to hold timeline data:</p> <ul><li>events: A set of TimelineEvents, ordered by the timestamp of the events in descending order. Each event contains one id and a map to store related information and is associated with one timestamp.</li> <li>configs: A map from a string (config name) to a string (config value) representing all configs associated with the entity. Users can post the whole config or a part of it in the configs field. Supported for application and generic entities. Supported for application and generic entities.</li> <li>metrics: A set of metrics related to this entity. There are two types of metrics: single value metric and time series metric. Each metric item contains metric name (id), value, and what kind of aggregation operation should be performed in this metric (no­op by default). Supported for flow run, application and generic entities.</li> <li>info: A map from a string (info key name) to an object (info value) to hold up related information for this entity. Supported for application and generic entities.</li> <li>isrelatedtoEntities and relatestoEntities: It is also possible to represent relationships between entities. Each entity contains a relatestoEntities and isrelatedtoEntities fields to represent relationships to other entities. Both fields are represented by a map from a string (the name of the relationship) to a timeline entity. In this way relationships among entities can be represented as a DAG.</li></ul> <p>Note that when posting timeline metrics, one may choose how each metric should be aggregated through the TimelineMetric#setRealtimeAggregationOp() method. The word “aggregate” here means applying one of the TimelineMetricOperation for a set of entities. Timeline service v2 provides built-in application level aggregation, which means aggregating metrics from different timeline entities within one YARN application. Right now, there are two kinds of operations supported in TimelineMetricOperation:</p> <ul><li>MAX: Getting the maximum value among all TimelineMetric objects.</li> <li>SUM: Getting the sum of all TimelineMetric objects.</li></ul> <p>By default, the NOP operation means not performing any real-time aggregation operation.</p> <p>Application frameworks must set the “flow context” whenever possible in order to take advantage of the flow support Timeline Service v.2 provides. The flow context consists of the following:</p> <ul><li>Flow name: a string that identifies the high-level flow (e.g. “distributed grep” or any identifiable name that can uniquely represent the app)</li> <li>Flow run id: a monotonically-increasing sequence of numbers that distinguish different runs of the same flow.</li> <li>(optional) Flow version: a string identifier that denotes a version of the flow. Flow version can be used to identify changes in the flows, such as code changes or script changes.</li></ul> <p>If the flow context is not specified, defaults are supplied for these attributes:</p> <ul><li>Flow name: the YARN application name (or the application id if the name is not set)</li> <li>Flow run id: the application start time in Unix time (milliseconds)</li> <li>Flow version: “1”</li></ul> <p>You can provide the flow context via YARN application tags:</p> <pre><code>ApplicationSubmissionContext appContext = app.getApplicationSubmissionContext();

// set the flow context as YARN application tags
Set&lt;String&gt; tags = new HashSet&lt;&gt;();
tags.add(TimelineUtils.generateFlowNameTag(&quot;distributed grep&quot;));
tags.add(Timelineutils.generateFlowVersionTag(&quot;3df8b0d6100530080d2e0decf9e528e57c42a90a&quot;));
tags.add(TimelineUtils.generateFlowRunIdTag(System.currentTimeMillis()));

appContext.setApplicationTags(tags);
</code></pre> <p>Note : The Resource Manager converts YARN application tags to lowercase before storing them. Hence one should convert Flow names and Flow versions to lowercase before using them in REST API queries.</p> <h2 id="timeline-service-v-2-rest-api"><a href="#timeline-service-v-2-rest-api" class="header-anchor">#</a> Timeline Service v.2 REST API</h2> <p>Querying Timeline Service v.2 is currently only supported via REST API; there is no API client implemented in the YARN libraries.</p> <p>The v.2 REST API is implemented at under the path, /ws/v2/timeline/ on the Timeline Service web service.</p> <p>Here is an informal description of the API.</p> <h3 id="root-path"><a href="#root-path" class="header-anchor">#</a> Root path</h3> <pre><code>GET /ws/v2/timeline/
</code></pre> <p>Returns a JSON object describing the service instance and version information.</p> <pre><code>{
  &quot;About&quot;:&quot;Timeline Reader API&quot;,
  &quot;timeline-service-version&quot;:&quot;3.0.0-alpha1-SNAPSHOT&quot;,
  &quot;timeline-service-build-version&quot;:&quot;3.0.0-alpha1-SNAPSHOT from fb0acd08e6f0b030d82eeb7cbfa5404376313e60 by sjlee source checksum be6cba0e42417d53be16459e1685e7&quot;,
  &quot;timeline-service-version-built-on&quot;:&quot;2016-04-11T23:15Z&quot;,
  &quot;hadoop-version&quot;:&quot;3.0.0-alpha1-SNAPSHOT&quot;,
  &quot;hadoop-build-version&quot;:&quot;3.0.0-alpha1-SNAPSHOT from fb0acd08e6f0b030d82eeb7cbfa5404376313e60 by sjlee source checksum ee968fd0aedcc7384230ee3ca216e790&quot;,
  &quot;hadoop-version-built-on&quot;:&quot;2016-04-11T23:14Z&quot;
}
</code></pre> <p>The following shows the supported queries on the REST API.</p> <h3 id="query-flows"><a href="#query-flows" class="header-anchor">#</a> Query Flows</h3> <p>With Query Flows API, you can retrieve a list of active flows that had runs most recently. If the REST endpoint without the cluster name is used, the cluster specified by the configuration yarn.resourcemanager.cluster-id in yarn-site.xml is taken. If none of the flows match the predicates, an empty list will be returned.</p> <h4 id="http-request"><a href="#http-request" class="header-anchor">#</a> HTTP request:</h4> <pre><code>GET /ws/v2/timeline/clusters/{cluster name}/flows/

or

GET /ws/v2/timeline/flows/
</code></pre> <h4 id="query-parameters-supported"><a href="#query-parameters-supported" class="header-anchor">#</a> Query Parameters Supported:</h4> <ol><li><p>limit - If specified, defines the number of flows to return. The maximum possible value for limit is maximum value of Long. If it is not specified or has a value less than 0, then limit will be considered as 100.</p></li> <li><p>daterange - If specified is given as “[startdate]-[enddate]”(i.e. start and end date separated by “-”) or single date. Dates are interpreted in the yyyyMMdd format and are assumed to be in UTC. If a single date is specified, all flows active on that date are returned. If both startdate and enddate is given, all flows active between start and end date will be returned. If only startdate is given, flows active on and after startdate are returned. If only enddate is given, flows active on and before enddate are returned.<br>
For example :<br>
“daterange=20150711” returns flows active on 20150711.<br>
“daterange=20150711-20150714” returns flows active between these 2 dates.<br>
“daterange=20150711-” returns flows active on and after 20150711.<br>
“daterange=-20150711” returns flows active on and before 20150711.</p></li> <li><p>fromid - If specified, retrieve the next set of flows from the given fromid. The set of entities retrieved is inclusive of specified fromid. fromid should be taken from the value associated with FROM_ID info key in flow entity response which was sent earlier.</p></li></ol> <h4 id="example-json-response"><a href="#example-json-response" class="header-anchor">#</a> Example JSON Response:</h4> <pre><code>[
  {
    &quot;metrics&quot;: [],
    &quot;events&quot;: [],
    &quot;id&quot;: &quot;test-cluster/1460419200000/sjlee@ds-date&quot;,
    &quot;type&quot;: &quot;YARN_FLOW_ACTIVITY&quot;,
    &quot;createdtime&quot;: 0,
    &quot;flowruns&quot;: [
      {
        &quot;metrics&quot;: [],
        &quot;events&quot;: [],
        &quot;id&quot;: &quot;sjlee@ds-date/1460420305659&quot;,
        &quot;type&quot;: &quot;YARN_FLOW_RUN&quot;,
        &quot;createdtime&quot;: 0,
        &quot;info&quot;: {
          &quot;SYSTEM_INFO_FLOW_VERSION&quot;: &quot;1&quot;,
          &quot;SYSTEM_INFO_FLOW_RUN_ID&quot;: 1460420305659,
          &quot;SYSTEM_INFO_FLOW_NAME&quot;: &quot;ds-date&quot;,
          &quot;SYSTEM_INFO_USER&quot;: &quot;sjlee&quot;
        },
        &quot;isrelatedto&quot;: {},
        &quot;relatesto&quot;: {}
      },
      {
        &quot;metrics&quot;: [],
        &quot;events&quot;: [],
        &quot;id&quot;: &quot;sjlee@ds-date/1460420587974&quot;,
        &quot;type&quot;: &quot;YARN_FLOW_RUN&quot;,
        &quot;createdtime&quot;: 0,
        &quot;info&quot;: {
          &quot;SYSTEM_INFO_FLOW_VERSION&quot;: &quot;1&quot;,
          &quot;SYSTEM_INFO_FLOW_RUN_ID&quot;: 1460420587974,
          &quot;SYSTEM_INFO_FLOW_NAME&quot;: &quot;ds-date&quot;,
          &quot;SYSTEM_INFO_USER&quot;: &quot;sjlee&quot;
        },
        &quot;isrelatedto&quot;: {},
        &quot;relatesto&quot;: {}
      }
    ],
    &quot;info&quot;: {
      &quot;SYSTEM_INFO_CLUSTER&quot;: &quot;test-cluster&quot;,
      &quot;UID&quot;: &quot;test-cluster!sjlee!ds-date&quot;,
      &quot;FROM_ID&quot;: &quot;test-cluster!1460419200000!sjlee!ds-date&quot;,
      &quot;SYSTEM_INFO_FLOW_NAME&quot;: &quot;ds-date&quot;,
      &quot;SYSTEM_INFO_DATE&quot;: 1460419200000,
      &quot;SYSTEM_INFO_USER&quot;: &quot;sjlee&quot;
    },
    &quot;isrelatedto&quot;: {},
    &quot;relatesto&quot;: {}
  }
]
</code></pre> <h4 id="response-codes"><a href="#response-codes" class="header-anchor">#</a> Response Codes</h4> <ol><li>If successful, a HTTP 200 (OK) response is returned.</li> <li>If any problem occurs in parsing request, HTTP 400 (Bad Request) is returned.</li> <li>For non-recoverable errors while retrieving data, HTTP 500 (Internal Server Error) is returned.</li></ol> <h3 id="query-flow-runs"><a href="#query-flow-runs" class="header-anchor">#</a> Query Flow Runs</h3> <p>With Query Flow Runs API, you can drill further down to get the runs (specific instances) of a given flow. This returns the most recent runs that belong to the given flow. If the REST endpoint without the cluster name is used, the cluster specified by the configuration yarn.resourcemanager.cluster-id in yarn-site.xml is taken. If none of the flow runs match the predicates, an empty list will be returned.</p> <h4 id="http-request-2"><a href="#http-request-2" class="header-anchor">#</a> HTTP request:</h4> <pre><code>GET /ws/v2/timeline/clusters/{cluster name}/users/{user name}/flows/{flow name}/runs/

or

GET /ws/v2/timeline/users/{user name}/flows/{flow name}/runs/
</code></pre> <h4 id="query-parameters-supported-2"><a href="#query-parameters-supported-2" class="header-anchor">#</a> Query Parameters Supported:</h4> <ol><li>limit - If specified, defines the number of flows to return. The maximum possible value for limit is maximum value of Long. If it is not specified or has a value less than 0, then limit will be considered as 100.</li> <li>createdtimestart - If specified, then only flow runs started after this timestamp are returned.</li> <li>createdtimeend - If specified, then only flow runs started before this timestamp are returned.</li> <li>metricstoretrieve - If specified, defines which metrics to retrieve or which ones not to retrieve and send back in response. metricstoretrieve can be an expression of the form :<br>
(<metricprefix>,<metricprefix>,<metricprefix>,<metricprefix>…)<br>
This specifies a comma separated list of metric id prefixes. Only metrics matching any of the prefixes will be retrieved. Brackets are optional for the simple expression. Alternatively, expressions can be of the form :<br>
!(<metricprefix>,<metricprefix>,<metricprefix>,<metricprefix>…)<br>
This specifies a comma separated list of metric id prefixes. Only metrics not matching any of the prefixes will be retrieved.<br>
If metricstoretrieve is specified, metrics will be retrieved irrespective of whether METRICS is specified in fields query param or not. Please note that URL unsafe characters such as spaces will have to be suitably encoded.</metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></li> <li>fields - Specifies which fields to retrieve. For querying flow runs, only ALL or METRICS are valid fields. Other fields will lead to HTTP 400 (Bad Request) response. If not specified, in response, id, type, createdtime and info fields will be returned.</li> <li>fromid - If specified, retrieve the next set of flow run entities from the given fromid. The set of entities retrieved is inclusive of specified fromid. fromid should be taken from the value associated with FROM_ID info key in flow entity response which was sent earlier.</li></ol> <h4 id="example-json-response-2"><a href="#example-json-response-2" class="header-anchor">#</a> Example JSON Response:</h4> <pre><code>[
  {
    &quot;metrics&quot;: [],
    &quot;events&quot;: [],
    &quot;id&quot;: &quot;sjlee@ds-date/1460420587974&quot;,
    &quot;type&quot;: &quot;YARN_FLOW_RUN&quot;,
    &quot;createdtime&quot;: 1460420587974,
    &quot;info&quot;: {
      &quot;UID&quot;: &quot;test-cluster!sjlee!ds-date!1460420587974&quot;,
      &quot;FROM_ID&quot;: &quot;test-cluster!sjlee!ds-date!1460420587974&quot;,
      &quot;SYSTEM_INFO_FLOW_RUN_ID&quot;: 1460420587974,
      &quot;SYSTEM_INFO_FLOW_NAME&quot;: &quot;ds-date&quot;,
      &quot;SYSTEM_INFO_FLOW_RUN_END_TIME&quot;: 1460420595198,
      &quot;SYSTEM_INFO_USER&quot;: &quot;sjlee&quot;
    },
    &quot;isrelatedto&quot;: {},
    &quot;relatesto&quot;: {}
  },
  {
    &quot;metrics&quot;: [],
    &quot;events&quot;: [],
    &quot;id&quot;: &quot;sjlee@ds-date/1460420305659&quot;,
    &quot;type&quot;: &quot;YARN_FLOW_RUN&quot;,
    &quot;createdtime&quot;: 1460420305659,
    &quot;info&quot;: {
      &quot;UID&quot;: &quot;test-cluster!sjlee!ds-date!1460420305659&quot;,
      &quot;FROM_ID&quot;: &quot;test-cluster!sjlee!ds-date!1460420305659&quot;,
      &quot;SYSTEM_INFO_FLOW_RUN_ID&quot;: 1460420305659,
      &quot;SYSTEM_INFO_FLOW_NAME&quot;: &quot;ds-date&quot;,
      &quot;SYSTEM_INFO_FLOW_RUN_END_TIME&quot;: 1460420311966,
      &quot;SYSTEM_INFO_USER&quot;: &quot;sjlee&quot;
    },
    &quot;isrelatedto&quot;: {},
    &quot;relatesto&quot;: {}
  }
]
</code></pre> <h4 id="response-codes-2"><a href="#response-codes-2" class="header-anchor">#</a> Response Codes</h4> <ol><li>If successful, a HTTP 200 (OK) response is returned.</li> <li>If any problem occurs in parsing request or if an invalid field is specified in fields query param, HTTP 400 (Bad Request) is returned.</li> <li>For non-recoverable errors while retrieving data, HTTP 500 (Internal Server Error) is returned.</li></ol> <h3 id="query-flow-run"><a href="#query-flow-run" class="header-anchor">#</a> Query Flow Run</h3> <p>With this API, you can query a specific flow run identified by cluster, user, flow name and run id. If the REST endpoint without the cluster name is used, the cluster specified by the configuration yarn.resourcemanager.cluster-id in yarn-site.xml is taken. Metrics are returned by default while querying individual flow runs.</p> <h4 id="http-request-3"><a href="#http-request-3" class="header-anchor">#</a> HTTP request:</h4> <pre><code>GET /ws/v2/timeline/clusters/{cluster name}/users/{user name}/flows/{flow name}/runs/{run id}

or

GET /ws/v2/timeline/users/{user name}/flows/{flow name}/runs/{run id}
</code></pre> <h4 id="query-parameters-supported-3"><a href="#query-parameters-supported-3" class="header-anchor">#</a> Query Parameters Supported:</h4> <ol><li>metricstoretrieve - If specified, defines which metrics to retrieve or which ones not to retrieve and send back in response. metricstoretrieve can be an expression of the form :<br>
(<metricprefix>,<metricprefix>,<metricprefix>,<metricprefix>…)<br>
This specifies a comma separated list of metric id prefixes. Only metrics matching any of the prefixes will be retrieved. Brackets are optional for the simple expression. Alternatively, expressions can be of the form :<br>
!(<metricprefix>,<metricprefix>,<metricprefix>,<metricprefix>…)<br>
This specifies a comma separated list of metric id prefixes. Only metrics not matching any of the prefixes will be retrieved.<br>
Please note that URL unsafe characters such as spaces will have to be suitably encoded.</metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></li></ol> <h4 id="example-json-response-3"><a href="#example-json-response-3" class="header-anchor">#</a> Example JSON Response:</h4> <pre><code>{
  &quot;metrics&quot;: [
    {
      &quot;type&quot;: &quot;SINGLE_VALUE&quot;,
      &quot;id&quot;: &quot;org.apache.hadoop.mapreduce.lib.input.FileInputFormatCounter:BYTES_READ&quot;,
      &quot;aggregationOp&quot;: &quot;NOP&quot;,
      &quot;values&quot;: {
        &quot;1465246377261&quot;: 118
      }
    },
    {
      &quot;type&quot;: &quot;SINGLE_VALUE&quot;,
      &quot;id&quot;: &quot;org.apache.hadoop.mapreduce.lib.output.FileOutputFormatCounter:BYTES_WRITTEN&quot;,
      &quot;aggregationOp&quot;: &quot;NOP&quot;,
      &quot;values&quot;: {
        &quot;1465246377261&quot;: 97
      }
    }
  ],
  &quot;events&quot;: [],
  &quot;id&quot;: &quot;varun@QuasiMonteCarlo/1465246348599&quot;,
  &quot;type&quot;: &quot;YARN_FLOW_RUN&quot;,
  &quot;createdtime&quot;: 1465246348599,
  &quot;isrelatedto&quot;: {},
  &quot;info&quot;: {
    &quot;UID&quot;:&quot;yarn-cluster!varun!QuasiMonteCarlo!1465246348599&quot;,
    &quot;FROM_ID&quot;:&quot;yarn-cluster!varun!QuasiMonteCarlo!1465246348599&quot;,
    &quot;SYSTEM_INFO_FLOW_RUN_END_TIME&quot;:1465246378051,
    &quot;SYSTEM_INFO_FLOW_NAME&quot;:&quot;QuasiMonteCarlo&quot;,
    &quot;SYSTEM_INFO_USER&quot;:&quot;varun&quot;,
    &quot;SYSTEM_INFO_FLOW_RUN_ID&quot;:1465246348599
  },
  &quot;relatesto&quot;: {}
}
</code></pre> <h4 id="response-codes-3"><a href="#response-codes-3" class="header-anchor">#</a> Response Codes</h4> <ol><li>If successful, a HTTP 200(OK) response is returned.</li> <li>If any problem occurs in parsing request, HTTP 400 (Bad Request) is returned.</li> <li>If flow run for the given flow run id cannot be found, HTTP 404 (Not Found) is returned.</li> <li>For non-recoverable errors while retrieving data, HTTP 500 (Internal Server Error) is returned.</li></ol> <h3 id="query-apps-for-a-flow"><a href="#query-apps-for-a-flow" class="header-anchor">#</a> Query Apps for a flow</h3> <p>With this API, you can query all the YARN applications that are part of a specific flow. If the REST endpoint without the cluster name is used, the cluster specified by the configuration yarn.resourcemanager.cluster-id in yarn-site.xml is taken. If the number of matching applications are more than the limit, the most recent apps up to the limit will be returned. If none of the apps match the predicates, an empty list will be returned.</p> <h4 id="http-request-4"><a href="#http-request-4" class="header-anchor">#</a> HTTP request:</h4> <pre><code>GET /ws/v2/timeline/clusters/{cluster name}/users/{user name}/flows/{flow name}/apps

or

GET /ws/v2/timeline/users/{user name}/flows/{flow name}/apps
</code></pre> <h4 id="query-parameters-supported-4"><a href="#query-parameters-supported-4" class="header-anchor">#</a> Query Parameters Supported:</h4> <ol><li>limit - If specified, defines the number of applications to return. The maximum possible value for limit is maximum value of Long. If it is not specified or has a value less than 0, then limit will be considered as 100.</li> <li>createdtimestart - If specified, then only applications created after this timestamp are returned.</li> <li>createdtimeend - If specified, then only applications created before this timestamp are returned.</li> <li>relatesto - If specified, matched applications must relate to or not relate to given entities associated with a entity type. relatesto is represented as an expression of the form :<br>
“(<entitytype>:<entityid>:<entityid>…,<entitytype>:<entityid>:<entityid>…) <op> !(<entitytype>:<entityid>:<entityid>…,<entitytype>:<entityid>:<entityid>…)”.<br>
If relatesto expression has entity type - entity id(s) relations specified within enclosing brackets proceeding “!”, this means apps with these relations in its relatesto field, will not be returned. For expressions or subexpressions without “!”, all apps which have the specified relations in its relatesto field, will be returned. “op” is a logical operator and can be either AND or OR. entity type can be followed by any number of entity id(s). And we can combine any number of ANDs’ and ORs’ to create complex expressions. Brackets can be used to club expressions together.<br>
For example : relatesto can be “(((type1:id1:id2:id3,type3:id9) AND !(type2:id7:id8)) OR (type1:id4))”.<br>
Please note that URL unsafe characters such as spaces will have to be suitably encoded.</entityid></entityid></entitytype></entityid></entityid></entitytype></op></entityid></entityid></entitytype></entityid></entityid></entitytype></li> <li>isrelatedto - If specified, matched applications must be related to or not related to given entities associated with a entity type. isrelatedto is represented in the same form as relatesto.</li> <li>infofilters - If specified, matched applications must have exact matches to the given info key and must be either equal or not equal to given value. The info key is a string but value can be any object. infofilters are represented as an expression of the form :<br>
“(<key><compareop><value>) <op> (<key><compareop><value>)”.<br>
Here op can be either of AND or OR. And compareop can be either of “eq”, “ne” or “ene”.<br>
“eq” means equals, “ne” means not equals and existence of key is not required for a match and “ene” means not equals but existence of key is required. We can combine any number of ANDs’ and ORs’ to create complex expressions. Brackets can be used to club expressions together.<br>
For example : infofilters can be “(((infokey1 eq value1) AND (infokey2 ne value1)) OR (infokey1 ene value3))”.<br>
Note : If value is an object then value can be given in the form of JSON format without any space.<br>
For example : infofilters can be (infokey1 eq {“<key>”:“<value>”,“<key>”:“<value>”…}).<br>
Please note that URL unsafe characters such as spaces will have to be suitably encoded.</value></key></value></key></value></compareop></key></op></value></compareop></key></li> <li>conffilters - If specified, matched applications must have exact matches to the given config name and must be either equal or not equal to the given config value. Both the config name and value must be strings. conffilters are represented in the same form as infofilters.</li> <li>metricfilters - If specified, matched applications must have exact matches to the given metric and satisfy the specified relation with the metric value. Metric id must be a string and and metric value must be an integral value. metricfilters are represented as an expression of the form :<br>
“(<metricid><compareop><metricvalue>) <op> (<metricid><compareop><metricvalue>)”.<br>
Here op can be either of AND or OR. And compareop can be either of “eq”, “ne”, “ene”, “gt”, “ge”, “lt” and “le”.<br>
“eq” means equals, “ne” means not equals and existence of metric is not required for a match, “ene” means not equals but existence of metric is required, “gt” means greater than, “ge” means greater than or equals, “lt” means less than and “le” means less than or equals. We can combine any number of ANDs’ and ORs’ to create complex expressions. Brackets can be used to club expressions together.<br>
For example : metricfilters can be “(((metric1 eq 50) AND (metric2 gt 40)) OR (metric1 lt 20))”.<br>
This in essence is an expression equivalent to “(metric1 == 50 AND metric2 &gt; 40) OR (metric1 &lt; 20)”<br>
Please note that URL unsafe characters such as spaces will have to be suitably encoded.</metricvalue></compareop></metricid></op></metricvalue></compareop></metricid></li> <li>eventfilters - If specified, matched applications must contain or not contain the given events depending on the expression. eventfilters is represented as an expression of the form :<br>
“(<eventid>,<eventid>) <op> !(<eventid>,<eventid>,<eventid>)”.<br>
Here, “!” means none of the comma-separated list of events within the enclosed brackets proceeding “!” must exist for a match to occur. If “!” is not specified, the specified events within the enclosed brackets must exist. op is a logical operator and can be either AND or OR. We can combine any number of ANDs’ and ORs’ to create complex expressions. Brackets can be used to club expressions together.<br>
For example : eventfilters can be “(((event1,event2) AND !(event4)) OR (event3,event7,event5))”.<br>
Please note that URL unsafe characters such as spaces will have to be suitably encoded.</eventid></eventid></eventid></op></eventid></eventid></li> <li>metricstoretrieve - If specified, defines which metrics to retrieve or which ones not to retrieve and send back in response. metricstoretrieve can be an expression of the form :<br>
(<metricprefix>,<metricprefix>,<metricprefix>,<metricprefix>…)<br>
This specifies a comma separated list of metric id prefixes. Only metrics matching any of the prefixes will be retrieved. Brackets are optional for the simple expression. Alternatively, expressions can be of the form:<br>
!(<metricprefix>,<metricprefix>,<metricprefix>,<metricprefix>…)<br>
This specifies a comma separated list of metric id prefixes. Only metrics not matching any of the prefixes will be retrieved.<br>
If metricstoretrieve is specified, metrics will be retrieved irrespective of whether METRICS is specified in fields query param or not. Please note that URL unsafe characters such as spaces will have to be suitably encoded.</metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></li> <li>confstoretrieve - If specified, defines which configs to retrieve or which ones not to retrieve and send back in response. confstoretrieve can be an expression of the form :<br>
(&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;…)<br>
This specifies a comma separated list of config name prefixes. Only configs matching any of the prefixes will be retrieved. Brackets are optional for the simple expression. Alternatively, expressions can be of the form:<br>
!(&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;…)<br>
This specifies a comma separated list of config name prefixes. Only configs not matching any of the prefixes will be retrieved.<br>
If confstoretrieve is specified, configs will be retrieved irrespective of whether CONFIGS is specified in fields query param or not. Please note that URL unsafe characters such as spaces will have to be suitably encoded.</li> <li>fields - Specifies which fields to retrieve. Possible values for fields can be EVENTS, INFO, CONFIGS, METRICS, RELATES_TO, IS_RELATED_TO and ALL. All fields will be retrieved if ALL is specified. Multiple fields can be specified as a comma-separated list. If fields is not specified, in response, app id, type (equivalent to YARN_APPLICATION), app createdtime and UID in info field will be returned.</li> <li>metricslimit - If specified, defines the number of metrics to return. Considered only if fields contains METRICS/ALL or metricstoretrieve is specified. Ignored otherwise. The maximum possible value for metricslimit can be maximum value of Integer. If it is not specified or has a value less than 1, and metrics have to be retrieved, then metricslimit will be considered as 1 i.e. latest single value of metric(s) will be returned.</li> <li>metricstimestart - If specified, then metrics for the entity after this timestamp are returned.</li> <li>metricstimeend - If specified, then metrics for the entity before this timestamp are returned.</li> <li>fromid - If specified, retrieve the next set of application entities from the given fromid. The set of entities retrieved is inclusive of specified fromid. fromid should be taken from the value associated with FROM_ID info key in flow entity response which was sent earlier.</li></ol> <h4 id="example-json-response-4"><a href="#example-json-response-4" class="header-anchor">#</a> Example JSON Response:</h4> <pre><code>[
  {
    &quot;metrics&quot;: [ ],
    &quot;events&quot;: [ ],
    &quot;type&quot;: &quot;YARN_APPLICATION&quot;,
    &quot;id&quot;: &quot;application_1465246237936_0001&quot;,
    &quot;createdtime&quot;: 1465246348599,
    &quot;isrelatedto&quot;: { },
    &quot;configs&quot;: { },
    &quot;info&quot;: {
      &quot;UID&quot;: &quot;yarn-cluster!application_1465246237936_0001&quot;
      &quot;FROM_ID&quot;: &quot;yarn-cluster!varun!QuasiMonteCarlo!1465246348599!application_1465246237936_0001&quot;,
    },
    &quot;relatesto&quot;: { }
  },
  {
    &quot;metrics&quot;: [ ],
    &quot;events&quot;: [ ],
    &quot;type&quot;: &quot;YARN_APPLICATION&quot;,
    &quot;id&quot;: &quot;application_1464983628730_0005&quot;,
    &quot;createdtime&quot;: 1465033881959,
    &quot;isrelatedto&quot;: { },
    &quot;configs&quot;: { },
    &quot;info&quot;: {
      &quot;UID&quot;: &quot;yarn-cluster!application_1464983628730_0005&quot;
      &quot;FROM_ID&quot;: &quot;yarn-cluster!varun!QuasiMonteCarlo!1465246348599!application_1464983628730_0005&quot;,
    },
    &quot;relatesto&quot;: { }
  }
]
</code></pre> <h4 id="response-codes-4"><a href="#response-codes-4" class="header-anchor">#</a> Response Codes</h4> <ol><li>If successful, a HTTP 200 (OK) response is returned.</li> <li>If any problem occurs in parsing request, HTTP 400 (Bad Request) is returned.</li> <li>For non-recoverable errors while retrieving data, HTTP 500 (Internal Server Error) is returned.</li></ol> <h3 id="query-apps-for-a-flow-run"><a href="#query-apps-for-a-flow-run" class="header-anchor">#</a> Query Apps for a flow run</h3> <p>With this API, you can query all the YARN applications that are part of a specific flow run. If the REST endpoint without the cluster name is used, the cluster specified by the configuration yarn.resourcemanager.cluster-id in yarn-site.xml is taken. If number of matching applications are more than the limit, the most recent apps up to the limit will be returned. If none of the apps match the predicates, an empty list will be returned.</p> <h4 id="http-request-5"><a href="#http-request-5" class="header-anchor">#</a> HTTP request:</h4> <pre><code>GET /ws/v2/timeline/clusters/{cluster name}/users/{user name}/flows/{flow name}/runs/{run id}/apps

or

GET /ws/v2/timeline/users/{user name}/flows/{flow name}/runs/{run id}/apps/
</code></pre> <h4 id="query-parameters-supported-5"><a href="#query-parameters-supported-5" class="header-anchor">#</a> Query Parameters Supported:</h4> <ol><li>limit - If specified, defines the number of applications to return. The maximum possible value for limit is maximum value of Long. If it is not specified or has a value less than 0, then limit will be considered as 100.</li> <li>createdtimestart - If specified, then only applications created after this timestamp are returned.</li> <li>createdtimeend - If specified, then only applications created before this timestamp are returned.</li> <li>relatesto - If specified, matched applications must relate to or not relate to given entities associated with a entity type. relatesto is represented as an expression of the form :<br>
“(<entitytype>:<entityid>:<entityid>…,<entitytype>:<entityid>:<entityid>…) <op> !(<entitytype>:<entityid>:<entityid>…,<entitytype>:<entityid>:<entityid>…)”.<br>
If relatesto expression has entity type - entity id(s) relations specified within enclosing brackets proceeding “!”, this means apps with these relations in its relatesto field, will not be returned. For expressions or subexpressions without “!”, all apps which have the specified relations in its relatesto field, will be returned. “op” is a logical operator and can be either AND or OR. entity type can be followed by any number of entity id(s). And we can combine any number of ANDs’ and ORs’ to create complex expressions. Brackets can be used to club expressions together.<br>
For example : relatesto can be “(((type1:id1:id2:id3,type3:id9) AND !(type2:id7:id8)) OR (type1:id4))”.<br>
Please note that URL unsafe characters such as spaces will have to be suitably encoded.</entityid></entityid></entitytype></entityid></entityid></entitytype></op></entityid></entityid></entitytype></entityid></entityid></entitytype></li> <li>isrelatedto - If specified, matched applications must be related to or not related to given entities associated with a entity type. isrelatedto is represented in the same form as relatesto.</li> <li>infofilters - If specified, matched applications must have exact matches to the given info key and must be either equal or not equal to given value. The info key is a string but value can be any object. infofilters are represented as an expression of the form :<br>
“(<key><compareop><value>) <op> (<key><compareop><value>)”.<br>
Here op can be either of AND or OR. And compareop can be either of “eq”, “ne” or “ene”.<br>
“eq” means equals, “ne” means not equals and existence of key is not required for a match and “ene” means not equals but existence of key is required. We can combine any number of ANDs’ and ORs’ to create complex expressions. Brackets can be used to club expressions together.<br>
For example : infofilters can be “(((infokey1 eq value1) AND (infokey2 ne value1)) OR (infokey1 ene value3))”.<br>
Note : If value is an object then value can be given in the form of JSON format without any space.<br>
For example : infofilters can be (infokey1 eq {“<key>”:“<value>”,“<key>”:“<value>”…}).<br>
Please note that URL unsafe characters such as spaces will have to be suitably encoded.</value></key></value></key></value></compareop></key></op></value></compareop></key></li> <li>conffilters - If specified, matched applications must have exact matches to the given config name and must be either equal or not equal to the given config value. Both the config name and value must be strings. conffilters are represented in the same form as infofilters.</li> <li>metricfilters - If specified, matched applications must have exact matches to the given metric and satisfy the specified relation with the metric value. Metric id must be a string and and metric value must be an integral value. metricfilters are represented as an expression of the form :<br>
“(<metricid><compareop><metricvalue>) <op> (<metricid><compareop><metricvalue>)”.<br>
Here op can be either of AND or OR. And compareop can be either of “eq”, “ne”, “ene”, “gt”, “ge”, “lt” and “le”.<br>
“eq” means equals, “ne” means not equals and existence of metric is not required for a match, “ene” means not equals but existence of metric is required, “gt” means greater than, “ge” means greater than or equals, “lt” means less than and “le” means less than or equals. We can combine any number of ANDs’ and ORs’ to create complex expressions. Brackets can be used to club expressions together.<br>
For example : metricfilters can be “(((metric1 eq 50) AND (metric2 gt 40)) OR (metric1 lt 20))”.<br>
This in essence is an expression equivalent to “(metric1 == 50 AND metric2 &gt; 40) OR (metric1 &lt; 20)”<br>
Please note that URL unsafe characters such as spaces will have to be suitably encoded.</metricvalue></compareop></metricid></op></metricvalue></compareop></metricid></li> <li>eventfilters - If specified, matched applications must contain or not contain the given events depending on the expression. eventfilters is represented as an expression of the form :<br>
“(<eventid>,<eventid>) <op> !(<eventid>,<eventid>,<eventid>)”.<br>
Here, “!” means none of the comma-separated list of events within the enclosed brackets proceeding “!” must exist for a match to occur. If “!” is not specified, the specified events within the enclosed brackets must exist. op is a logical operator and can be either AND or OR. We can combine any number of ANDs’ and ORs’ to create complex expressions. Brackets can be used to club expressions together.<br>
For example : eventfilters can be “(((event1,event2) AND !(event4)) OR (event3,event7,event5))”.<br>
Please note that URL unsafe characters such as spaces will have to be suitably encoded.</eventid></eventid></eventid></op></eventid></eventid></li> <li>metricstoretrieve - If specified, defines which metrics to retrieve or which ones not to retrieve and send back in response. metricstoretrieve can be an expression of the form :<br>
(<metricprefix>,<metricprefix>,<metricprefix>,<metricprefix>…)<br>
This specifies a comma separated list of metric id prefixes. Only metrics matching any of the prefixes will be retrieved. Brackets are optional for the simple expression. Alternatively, expressions can be of the form :<br>
!(<metricprefix>,<metricprefix>,<metricprefix>,<metricprefix>…)<br>
This specifies a comma separated list of metric id prefixes. Only metrics not matching any of the prefixes will be retrieved.<br>
If metricstoretrieve is specified, metrics will be retrieved irrespective of whether METRICS is specified in fields query param or not. Please note that URL unsafe characters such as spaces will have to be suitably encoded.</metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></li> <li>confstoretrieve - If specified, defines which configs to retrieve or which ones not to retrieve and send back in response. confstoretrieve can be an expression of the form :<br>
(&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;…)<br>
This specifies a comma separated list of config name prefixes. Only configs matching any of the prefixes will be retrieved. Brackets are optional for the simple expression. Alternatively, expressions can be of the form :<br>
!(&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;…)<br>
This specifies a comma separated list of config name prefixes. Only configs not matching any of the prefixes will be retrieved.<br>
If confstoretrieve is specified, configs will be retrieved irrespective of whether CONFIGS is specified in fields query param or not. Please note that URL unsafe characters such as spaces will have to be suitably encoded.</li> <li>fields - Specifies which fields to retrieve. Possible values for fields can be EVENTS, INFO, CONFIGS, METRICS, RELATES_TO, IS_RELATED_TO and ALL. All fields will be retrieved if ALL is specified. Multiple fields can be specified as a comma-separated list. If fields is not specified, in response, app id, type (equivalent to YARN_APPLICATION), app createdtime and UID in info field will be returned.</li> <li>metricslimit - If specified, defines the number of metrics to return. Considered only if fields contains METRICS/ALL or metricstoretrieve is specified. Ignored otherwise. The maximum possible value for metricslimit can be maximum value of Integer. If it is not specified or has a value less than 1, and metrics have to be retrieved, then metricslimit will be considered as 1 i.e. latest single value of metric(s) will be returned.</li> <li>metricstimestart - If specified, then metrics for the entity after this timestamp are returned.</li> <li>metricstimeend - If specified, then metrics for the entity before this timestamp are returned.</li> <li>fromid - If specified, retrieve the next set of application entities from the given fromid. The set of entities retrieved is inclusive of specified fromid. fromid should be taken from the value associated with FROM_ID info key in flow entity response which was sent earlier.</li></ol> <h4 id="example-json-response-5"><a href="#example-json-response-5" class="header-anchor">#</a> Example JSON Response:</h4> <pre><code>[
  {
    &quot;metrics&quot;: [],
    &quot;events&quot;: [],
    &quot;id&quot;: &quot;application_1460419579913_0002&quot;,
    &quot;type&quot;: &quot;YARN_APPLICATION&quot;,
    &quot;createdtime&quot;: 1460419580171,
    &quot;info&quot;: {
      &quot;UID&quot;: &quot;test-cluster!sjlee!ds-date!1460419580171!application_1460419579913_0002&quot;
      &quot;FROM_ID&quot;: &quot;test-cluster!sjlee!ds-date!1460419580171!application_1460419579913_0002&quot;,
    },
    &quot;configs&quot;: {},
    &quot;isrelatedto&quot;: {},
    &quot;relatesto&quot;: {}
  }
]
</code></pre> <h4 id="response-codes-5"><a href="#response-codes-5" class="header-anchor">#</a> Response Codes</h4> <ol><li>If successful, a HTTP 200 (OK) response is returned.</li> <li>If any problem occurs in parsing request, HTTP 400 (Bad Request) is returned.</li> <li>For non-recoverable errors while retrieving data, HTTP 500 (Internal Server Error) is returned.</li></ol> <h3 id="query-app"><a href="#query-app" class="header-anchor">#</a> Query app</h3> <p>With this API, you can query a single YARN application identified by the cluster and the application ID. If the REST endpoint without the cluster name is used, the cluster specified by the configuration yarn.resourcemanager.cluster-id in yarn-site.xml is taken. Flow context information i.e. user, flow name and run id are not mandatory but if specified in query param can preclude the need for an additional operation to fetch flow context information based on cluster and app id.</p> <h4 id="http-request-6"><a href="#http-request-6" class="header-anchor">#</a> HTTP request:</h4> <pre><code>GET /ws/v2/timeline/clusters/{cluster name}/apps/{app id}

or

GET /ws/v2/timeline/apps/{app id}
</code></pre> <h4 id="query-parameters-supported-6"><a href="#query-parameters-supported-6" class="header-anchor">#</a> Query Parameters Supported:</h4> <ol><li>userid - If specified, only applications belonging to this user will be returned. This query param must be specified along with flowname and flowrunid query params, otherwise it will be ignored. If userid, flowname and flowrunid are not specified, we would have to fetch flow context information based on cluster and appid while executing the query.</li> <li>flowname - Only applications belonging to this flowname will be returned. This query param must be specified along with userid and flowrunid query params, otherwise it will be ignored. If userid, flowname and flowrunid are not specified, we would have to fetch flow context information based on cluster and appid while executing the query.</li> <li>flowrunid - Only applications belonging to this flow run id will be returned. This query param must be specified along with userid and flowname query params, otherwise it will be ignored. If userid, flowname and flowrunid are not specified, we would have to fetch flow context information based on cluster and appid while executing the query.</li> <li>metricstoretrieve - If specified, defines which metrics to retrieve or which ones not to retrieve and send back in response. metricstoretrieve can be an expression of the form :<br>
(<metricprefix>,<metricprefix>,<metricprefix>,<metricprefix>…)<br>
This specifies a comma separated list of metric id prefixes. Only metrics matching any of the prefixes will be retrieved. Brackets are optional for the simple expression. Alternatively, expressions can be of the form :<br>
!(<metricprefix>,<metricprefix>,<metricprefix>,<metricprefix>…)<br>
This specifies a comma separated list of metric id prefixes. Only metrics not matching any of the prefixes will be retrieved.<br>
If metricstoretrieve is specified, metrics will be retrieved irrespective of whether METRICS is specified in fields query param or not. Please note that URL unsafe characters such as spaces will have to be suitably encoded.</metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></li> <li>confstoretrieve - If specified, defines which configs to retrieve or which ones not to retrieve and send back in response. confstoretrieve can be an expression of the form :<br>
(&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;…)<br>
This specifies a comma separated list of config name prefixes. Only configs matching any of the prefixes will be retrieved. Brackets are optional for the simple expression. Alternatively, expressions can be of the form :<br>
!(&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;…)<br>
This specifies a comma separated list of config name prefixes. Only configs not matching any of the prefixes will be retrieved.<br>
If confstoretrieve is specified, configs will be retrieved irrespective of whether CONFIGS is specified in fields query param or not. Please note that URL unsafe characters such as spaces will have to be suitably encoded.</li> <li>fields - Specifies which fields to retrieve. Possible values for fields can be EVENTS, INFO, CONFIGS, METRICS, RELATES_TO, IS_RELATED_TO and ALL. All fields will be retrieved if ALL is specified. Multiple fields can be specified as a comma-separated list. If fields is not specified, in response, app id, type (equivalent to YARN_APPLICATION), app createdtime and UID in info field will be returned.</li> <li>metricslimit - If specified, defines the number of metrics to return. Considered only if fields contains METRICS/ALL or metricstoretrieve is specified. Ignored otherwise. The maximum possible value for metricslimit can be maximum value of Integer. If it is not specified or has a value less than 1, and metrics have to be retrieved, then metricslimit will be considered as 1 i.e. latest single value of metric(s) will be returned.</li> <li>metricstimestart - If specified, then metrics for the entity after this timestamp are returned.</li> <li>metricstimeend - If specified, then metrics for the entity before this timestamp are returned.</li></ol> <h4 id="example-json-response-6"><a href="#example-json-response-6" class="header-anchor">#</a> Example JSON Response:</h4> <pre><code>{
  &quot;metrics&quot;: [],
  &quot;events&quot;: [],
  &quot;id&quot;: &quot;application_1460419579913_0002&quot;,
  &quot;type&quot;: &quot;YARN_APPLICATION&quot;,
  &quot;createdtime&quot;: 1460419580171,
  &quot;info&quot;: {
    &quot;UID&quot;: &quot;test-cluster!sjlee!ds-date!1460419580171!application_1460419579913_0002&quot;
  },
  &quot;configs&quot;: {},
  &quot;isrelatedto&quot;: {},
  &quot;relatesto&quot;: {}
}
</code></pre> <h4 id="response-codes-6"><a href="#response-codes-6" class="header-anchor">#</a> Response Codes</h4> <ol><li>If successful, a HTTP 200(OK) response is returned.</li> <li>If any problem occurs in parsing request, HTTP 400 (Bad Request) is returned.</li> <li>If flow context information cannot be retrieved or application for the given app id cannot be found, HTTP 404 (Not Found) is returned.</li> <li>For non-recoverable errors while retrieving data, HTTP 500 (Internal Server Error) is returned.</li></ol> <h3 id="query-generic-entities-with-in-the-scope-of-application"><a href="#query-generic-entities-with-in-the-scope-of-application" class="header-anchor">#</a> Query generic entities with in the scope of Application</h3> <p>With this API, you can query generic entities identified by cluster ID, application ID and per-framework entity type. If the REST endpoint without the cluster name is used, the cluster specified by the configuration yarn.resourcemanager.cluster-id in yarn-site.xml is taken. Flow context information i.e. user, flow name and run id are not mandatory but if specified in query param can preclude the need for an additional operation to fetch flow context information based on cluster and app id. If number of matching entities are more than the limit, the most recent entities up to the limit will be returned. This endpoint can be used to query containers, application attempts or any other generic entity which clients put into the backend. For instance, we can query containers by specifying entity type as YARN_CONTAINER and application attempts by specifying entity type as YARN_APPLICATION_ATTEMPT. If none of the entities match the predicates, an empty list will be returned.</p> <h4 id="http-request-7"><a href="#http-request-7" class="header-anchor">#</a> HTTP request:</h4> <pre><code>GET /ws/v2/timeline/clusters/{cluster name}/apps/{app id}/entities/{entity type}

or

GET /ws/v2/timeline/apps/{app id}/entities/{entity type}
</code></pre> <h4 id="query-parameters-supported-7"><a href="#query-parameters-supported-7" class="header-anchor">#</a> Query Parameters Supported:</h4> <ol><li>userid - If specified, only entities belonging to this user will be returned. This query param must be specified along with flowname and flowrunid query params, otherwise it will be ignored. If userid, flowname and flowrunid are not specified, we would have to fetch flow context information based on cluster and appid while executing the query.</li> <li>flowname - If specified, only entities belonging to this flowname will be returned. This query param must be specified along with userid and flowrunid query params, otherwise it will be ignored. If userid, flowname and flowrunid are not specified, we would have to fetch flow context information based on cluster and appid while executing the query.</li> <li>flowrunid - If specified, only entities belonging to this flow run id will be returned. This query param must be specified along with userid and flowname query params, otherwise it will be ignored. If userid, flowname and flowrunid are not specified, we would have to fetch flow context information based on cluster and appid while executing the query.</li> <li>limit - If specified, defines the number of entities to return. The maximum possible value for limit is maximum value of Long. If it is not specified or has a value less than 0, then limit will be considered as 100.</li> <li>createdtimestart - If specified, then only entities created after this timestamp are returned.</li> <li>createdtimeend - If specified, then only entities created before this timestamp are returned.</li> <li>relatesto - If specified, matched entities must relate to or not relate to given entities associated with a entity type. relatesto is represented as an expression of the form :<br>
“(<entitytype>:<entityid>:<entityid>…,<entitytype>:<entityid>:<entityid>…) <op> !(<entitytype>:<entityid>:<entityid>…,<entitytype>:<entityid>:<entityid>…)”.<br>
If relatesto expression has entity type - entity id(s) relations specified within enclosing brackets proceeding “!”, this means entities with these relations in its relatesto field, will not be returned. For expressions or subexpressions without “!”, all entities which have the specified relations in its relatesto field, will be returned. “op” is a logical operator and can be either AND or OR. entity type can be followed by any number of entity id(s). And we can combine any number of ANDs’ and ORs’ to create complex expressions. Brackets can be used to club expressions together.<br>
For example : relatesto can be “(((type1:id1:id2:id3,type3:id9) AND !(type2:id7:id8)) OR (type1:id4))”.<br>
Please note that URL unsafe characters such as spaces will have to be suitably encoded.</entityid></entityid></entitytype></entityid></entityid></entitytype></op></entityid></entityid></entitytype></entityid></entityid></entitytype></li> <li>isrelatedto - If specified, matched entities must be related to or not related to given entities associated with a entity type. isrelatedto is represented in the same form as relatesto.</li> <li>infofilters - If specified, matched entities must have exact matches to the given info key and must be either equal or not equal to given value. The info key is a string but value can be any object. infofilters are represented as an expression of the form :<br>
“(<key><compareop><value>) <op> (<key><compareop><value>)”.<br>
Here op can be either of AND or OR. And compareop can be either of “eq”, “ne” or “ene”.<br>
“eq” means equals, “ne” means not equals and existence of key is not required for a match and “ene” means not equals but existence of key is required. We can combine any number of ANDs’ and ORs’ to create complex expressions. Brackets can be used to club expressions together.<br>
For example : infofilters can be “(((infokey1 eq value1) AND (infokey2 ne value1)) OR (infokey1 ene value3))”.<br>
Note : If value is an object then value can be given in the form of JSON format without any space.<br>
For example : infofilters can be (infokey1 eq {“<key>”:“<value>”,“<key>”:“<value>”…}).<br>
Please note that URL unsafe characters such as spaces will have to be suitably encoded.</value></key></value></key></value></compareop></key></op></value></compareop></key></li> <li>conffilters - If specified, matched entities must have exact matches to the given config name and must be either equal or not equal to the given config value. Both the config name and value must be strings. conffilters are represented in the same form as infofilters.</li> <li>metricfilters - If specified, matched entities must have exact matches to the given metric and satisfy the specified relation with the metric value. Metric id must be a string and and metric value must be an integral value. metricfilters are represented as an expression of the form :<br>
“(<metricid><compareop><metricvalue>) <op> (<metricid><compareop><metricvalue>)”<br>
Here op can be either of AND or OR. And compareop can be either of “eq”, “ne”, “ene”, “gt”, “ge”, “lt” and “le”.<br>
“eq” means equals, “ne” means not equals and existence of metric is not required for a match, “ene” means not equals but existence of metric is required, “gt” means greater than, “ge” means greater than or equals, “lt” means less than and “le” means less than or equals. We can combine any number of ANDs’ and ORs’ to create complex expressions. Brackets can be used to club expressions together.<br>
For example : metricfilters can be “(((metric1 eq 50) AND (metric2 gt 40)) OR (metric1 lt 20))”.<br>
This in essence is an expression equivalent to “(metric1 == 50 AND metric2 &gt; 40) OR (metric1 &lt; 20)”<br>
Please note that URL unsafe characters such as spaces will have to be suitably encoded.</metricvalue></compareop></metricid></op></metricvalue></compareop></metricid></li> <li>eventfilters - If specified, matched entities must contain or not contain the given events depending on the expression. eventfilters is represented as an expression of the form :<br>
“(<eventid>,<eventid>) <op> !(<eventid>,<eventid>,<eventid>)”.<br>
Here, “!” means none of the comma-separated list of events within the enclosed brackets proceeding “!” must exist for a match to occur. If “!” is not specified, the specified events within the enclosed brackets must exist. op is a logical operator and can be either AND or OR. We can combine any number of ANDs’ and ORs’ to create complex expressions. Brackets can be used to club expressions together.<br>
For example : eventfilters can be “(((event1,event2) AND !(event4)) OR (event3,event7,event5))”.<br>
Please note that URL unsafe characters such as spaces will have to be suitably encoded.</eventid></eventid></eventid></op></eventid></eventid></li> <li>metricstoretrieve - If specified, defines which metrics to retrieve or which ones not to retrieve and send back in response. metricstoretrieve can be an expression of the form :<br>
(<metricprefix>,<metricprefix>,<metricprefix>,<metricprefix>…)<br>
This specifies a comma separated list of metric id prefixes. Only metrics matching any of the prefixes will be retrieved. Brackets are optional for the simple expression. Alternatively, expressions can be of the form:<br>
!(<metricprefix>,<metricprefix>,<metricprefix>,<metricprefix>…)<br>
This specifies a comma separated list of metric id prefixes. Only metrics not matching any of the prefixes will be retrieved.<br>
If metricstoretrieve is specified, metrics will be retrieved irrespective of whether METRICS is specified in fields query param or not. Please note that URL unsafe characters such as spaces will have to be suitably encoded.</metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></li> <li>confstoretrieve - If specified, defines which configs to retrieve or which ones not to retrieve and send back in response. confstoretrieve can be an expression of the form :<br>
(&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;…)<br>
This specifies a comma separated list of config name prefixes. Only configs matching any of the prefixes will be retrieved. Brackets are optional for the simple expression. Alternatively, expressions can be of the form:<br>
!(&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;…)<br>
This specifies a comma separated list of config name prefixes. Only configs not matching any of the prefixes will be retrieved.<br>
If confstoretrieve is specified, configs will be retrieved irrespective of whether CONFIGS is specified in fields query param or not. Please note that URL unsafe characters such as spaces will have to be suitably encoded.</li> <li>fields - Specifies which fields to retrieve. Possible values for fields can be EVENTS, INFO, CONFIGS, METRICS, RELATES_TO, IS_RELATED_TO and ALL. All fields will be retrieved if ALL is specified. Multiple fields can be specified as a comma-separated list. If fields is not specified, in response, entity id, entity type, createdtime and UID in info field will be returned.</li> <li>metricslimit - If specified, defines the number of metrics to return. Considered only if fields contains METRICS/ALL or metricstoretrieve is specified. Ignored otherwise. The maximum possible value for metricslimit can be maximum value of Integer. If it is not specified or has a value less than 1, and metrics have to be retrieved, then metricslimit will be considered as 1 i.e. latest single value of metric(s) will be returned.</li> <li>metricstimestart - If specified, then metrics for the entity after this timestamp are returned.</li> <li>metricstimeend - If specified, then metrics for the entity before this timestamp are returned.</li> <li>fromid - If specified, retrieve the next set of generic entities from the given fromid. The set of entities retrieved is inclusive of specified fromid. fromid should be taken from the value associated with FROM_ID info key in flow entity response which was sent earlier.</li></ol> <h4 id="example-json-response-7"><a href="#example-json-response-7" class="header-anchor">#</a> Example JSON Response:</h4> <pre><code>[
  {
    &quot;metrics&quot;: [ ],
    &quot;events&quot;: [ ],
    &quot;type&quot;: &quot;YARN_APPLICATION_ATTEMPT&quot;,
    &quot;id&quot;: &quot;appattempt_1465246237936_0001_000001&quot;,
    &quot;createdtime&quot;: 1465246358873,
    &quot;isrelatedto&quot;: { },
    &quot;configs&quot;: { },
    &quot;info&quot;: {
      &quot;UID&quot;: &quot;yarn-cluster!application_1465246237936_0001!YARN_APPLICATION_ATTEMPT!appattempt_1465246237936_0001_000001&quot;
      &quot;FROM_ID&quot;: &quot;yarn-cluster!sjlee!ds-date!1460419580171!application_1465246237936_0001!YARN_APPLICATION_ATTEMPT!0!appattempt_1465246237936_0001_000001&quot;
    },
    &quot;relatesto&quot;: { }
  },
  {
    &quot;metrics&quot;: [ ],
    &quot;events&quot;: [ ],
    &quot;type&quot;: &quot;YARN_APPLICATION_ATTEMPT&quot;,
    &quot;id&quot;: &quot;appattempt_1465246237936_0001_000002&quot;,
    &quot;createdtime&quot;: 1465246359045,
    &quot;isrelatedto&quot;: { },
    &quot;configs&quot;: { },
    &quot;info&quot;: {
      &quot;UID&quot;: &quot;yarn-cluster!application_1465246237936_0001!YARN_APPLICATION_ATTEMPT!appattempt_1465246237936_0001_000002&quot;
      &quot;FROM_ID&quot;: &quot;yarn-cluster!sjlee!ds-date!1460419580171!application_1465246237936_0001!YARN_APPLICATION_ATTEMPT!0!appattempt_1465246237936_0001_000002&quot;
    },
    &quot;relatesto&quot;: { }
  }
]
</code></pre> <h4 id="response-codes-7"><a href="#response-codes-7" class="header-anchor">#</a> Response Codes</h4> <ol><li>If successful, a HTTP 200(OK) response is returned.</li> <li>If any problem occurs in parsing request, HTTP 400 (Bad Request) is returned.</li> <li>If flow context information cannot be retrieved, HTTP 404 (Not Found) is returned.</li> <li>For non-recoverable errors while retrieving data, HTTP 500 (Internal Server Error) is returned.</li></ol> <h3 id="query-generic-entities"><a href="#query-generic-entities" class="header-anchor">#</a> Query generic entities.</h3> <p>With this API, you can query generic entities per user identified by cluster ID, doAsUser and entity type. If the REST endpoint without the cluster name is used, the cluster specified by the configuration yarn.resourcemanager.cluster-id in yarn-site.xml is taken. If number of matching entities are more than the limit, the most recent entities up to the limit will be returned. This endpoint can be used to query generic entity which clients put into the backend. For instance, we can query user entities by specifying entity type as TEZ_DAG_ID. If none of the entities match the predicates, an empty list will be returned. Note : As of today, we can query only those entities which are published with doAsUser which is different from application owner.</p> <h4 id="http-request-8"><a href="#http-request-8" class="header-anchor">#</a> HTTP request:</h4> <pre><code>GET /ws/v2/timeline/clusters/{cluster name}/users/{userid}/entities/{entitytype}

or

GET /ws/v2/timeline/users/{userid}/entities/{entitytype}
</code></pre> <h4 id="query-parameters-supported-8"><a href="#query-parameters-supported-8" class="header-anchor">#</a> Query Parameters Supported:</h4> <ol><li>limit - If specified, defines the number of entities to return. The maximum possible value for limit is maximum value of Long. If it is not specified or has a value less than 0, then limit will be considered as 100.</li> <li>createdtimestart - If specified, then only entities created after this timestamp are returned.</li> <li>createdtimeend - If specified, then only entities created before this timestamp are returned.</li> <li>relatesto - If specified, matched entities must relate to or not relate to given entities associated with a entity type. relatesto is represented as an expression of the form :<br>
“(<entitytype>:<entityid>:<entityid>…,<entitytype>:<entityid>:<entityid>…) <op> !(<entitytype>:<entityid>:<entityid>…,<entitytype>:<entityid>:<entityid>…)”.<br>
If relatesto expression has entity type - entity id(s) relations specified within enclosing brackets proceeding “!”, this means entities with these relations in its relatesto field, will not be returned. For expressions or subexpressions without “!”, all entities which have the specified relations in its relatesto field, will be returned. “op” is a logical operator and can be either AND or OR. entity type can be followed by any number of entity id(s). And we can combine any number of ANDs’ and ORs’ to create complex expressions. Brackets can be used to club expressions together.<br>
For example : relatesto can be “(((type1:id1:id2:id3,type3:id9) AND !(type2:id7:id8)) OR (type1:id4))”.<br>
Please note that URL unsafe characters such as spaces will have to be suitably encoded.</entityid></entityid></entitytype></entityid></entityid></entitytype></op></entityid></entityid></entitytype></entityid></entityid></entitytype></li> <li>isrelatedto - If specified, matched entities must be related to or not related to given entities associated with a entity type. isrelatedto is represented in the same form as relatesto.</li> <li>infofilters - If specified, matched entities must have exact matches to the given info key and must be either equal or not equal to given value. The info key is a string but value can be any object. infofilters are represented as an expression of the form :<br>
“(<key><compareop><value>) <op> (<key><compareop><value>)”.<br>
Here op can be either of AND or OR. And compareop can be either of “eq”, “ne” or “ene”.<br>
“eq” means equals, “ne” means not equals and existence of key is not required for a match and “ene” means not equals but existence of key is required. We can combine any number of ANDs’ and ORs’ to create complex expressions. Brackets can be used to club expressions together.<br>
For example : infofilters can be “(((infokey1 eq value1) AND (infokey2 ne value1)) OR (infokey1 ene value3))”.<br>
Note : If value is an object then value can be given in the form of JSON format without any space.<br>
For example : infofilters can be (infokey1 eq {“<key>”:“<value>”,“<key>”:“<value>”…}).<br>
Please note that URL unsafe characters such as spaces will have to be suitably encoded.</value></key></value></key></value></compareop></key></op></value></compareop></key></li> <li>conffilters - If specified, matched entities must have exact matches to the given config name and must be either equal or not equal to the given config value. Both the config name and value must be strings. conffilters are represented in the same form as infofilters.</li> <li>metricfilters - If specified, matched entities must have exact matches to the given metric and satisfy the specified relation with the metric value. Metric id must be a string and and metric value must be an integral value. metricfilters are represented as an expression of the form :<br>
“(<metricid><compareop><metricvalue>) <op> (<metricid><compareop><metricvalue>)”<br>
Here op can be either of AND or OR. And compareop can be either of “eq”, “ne”, “ene”, “gt”, “ge”, “lt” and “le”.<br>
“eq” means equals, “ne” means not equals and existence of metric is not required for a match, “ene” means not equals but existence of metric is required, “gt” means greater than, “ge” means greater than or equals, “lt” means less than and “le” means less than or equals. We can combine any number of ANDs’ and ORs’ to create complex expressions. Brackets can be used to club expressions together.<br>
For example : metricfilters can be “(((metric1 eq 50) AND (metric2 gt 40)) OR (metric1 lt 20))”.<br>
This in essence is an expression equivalent to “(metric1 == 50 AND metric2 &gt; 40) OR (metric1 &lt; 20)”<br>
Please note that URL unsafe characters such as spaces will have to be suitably encoded.</metricvalue></compareop></metricid></op></metricvalue></compareop></metricid></li> <li>eventfilters - If specified, matched entities must contain or not contain the given events depending on the expression. eventfilters is represented as an expression of the form :<br>
“(<eventid>,<eventid>) <op> !(<eventid>,<eventid>,<eventid>)”.<br>
Here, “!” means none of the comma-separated list of events within the enclosed brackets proceeding “!” must exist for a match to occur. If “!” is not specified, the specified events within the enclosed brackets must exist. op is a logical operator and can be either AND or OR. We can combine any number of ANDs’ and ORs’ to create complex expressions. Brackets can be used to club expressions together.<br>
For example : eventfilters can be “(((event1,event2) AND !(event4)) OR (event3,event7,event5))”.<br>
Please note that URL unsafe characters such as spaces will have to be suitably encoded.</eventid></eventid></eventid></op></eventid></eventid></li> <li>metricstoretrieve - If specified, defines which metrics to retrieve or which ones not to retrieve and send back in response. metricstoretrieve can be an expression of the form :<br>
(<metricprefix>,<metricprefix>,<metricprefix>,<metricprefix>…)<br>
This specifies a comma separated list of metric id prefixes. Only metrics matching any of the prefixes will be retrieved. Brackets are optional for the simple expression. Alternatively, expressions can be of the form:<br>
!(<metricprefix>,<metricprefix>,<metricprefix>,<metricprefix>…)<br>
This specifies a comma separated list of metric id prefixes. Only metrics not matching any of the prefixes will be retrieved.<br>
If metricstoretrieve is specified, metrics will be retrieved irrespective of whether METRICS is specified in fields query param or not. Please note that URL unsafe characters such as spaces will have to be suitably encoded.</metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></li> <li>confstoretrieve - If specified, defines which configs to retrieve or which ones not to retrieve and send back in response. confstoretrieve can be an expression of the form :<br>
(&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;…)<br>
This specifies a comma separated list of config name prefixes. Only configs matching any of the prefixes will be retrieved. Brackets are optional for the simple expression. Alternatively, expressions can be of the form:<br>
!(&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;…)<br>
This specifies a comma separated list of config name prefixes. Only configs not matching any of the prefixes will be retrieved.<br>
If confstoretrieve is specified, configs will be retrieved irrespective of whether CONFIGS is specified in fields query param or not. Please note that URL unsafe characters such as spaces will have to be suitably encoded.</li> <li>fields - Specifies which fields to retrieve. Possible values for fields can be EVENTS, INFO, CONFIGS, METRICS, RELATES_TO, IS_RELATED_TO and ALL. All fields will be retrieved if ALL is specified. Multiple fields can be specified as a comma-separated list. If fields is not specified, in response, entity id, entity type, createdtime and UID in info field will be returned.</li> <li>metricslimit - If specified, defines the number of metrics to return. Considered only if fields contains METRICS/ALL or metricstoretrieve is specified. Ignored otherwise. The maximum possible value for metricslimit can be maximum value of Integer. If it is not specified or has a value less than 1, and metrics have to be retrieved, then metricslimit will be considered as 1 i.e. latest single value of metric(s) will be returned.</li> <li>metricstimestart - If specified, then metrics for the entity after this timestamp are returned.</li> <li>metricstimeend - If specified, then metrics for the entity before this timestamp are returned.</li> <li>fromid - If specified, retrieve the next set of generic entities from the given fromid. The set of entities retrieved is inclusive of specified fromid. fromid should be taken from the value associated with FROM_ID info key in flow entity response which was sent earlier.</li></ol> <h4 id="example-json-response-8"><a href="#example-json-response-8" class="header-anchor">#</a> Example JSON Response:</h4> <pre><code>[
  {
    &quot;metrics&quot;: [ ],
    &quot;events&quot;: [ ],
    &quot;type&quot;: &quot;TEZ_DAG_ID&quot;,
    &quot;id&quot;: &quot;dag_1465246237936_0001_000001&quot;,
    &quot;createdtime&quot;: 1465246358873,
    &quot;isrelatedto&quot;: { },
    &quot;configs&quot;: { },
    &quot;info&quot;: {
      &quot;UID&quot;: &quot;yarn-cluster!sjlee!TEZ_DAG_ID!0!dag_1465246237936_0001_000001&quot;
      &quot;FROM_ID&quot;: &quot;sjlee!yarn-cluster!TEZ_DAG_ID!0!dag_1465246237936_0001_000001&quot;
    },
    &quot;relatesto&quot;: { }
  },
  {
    &quot;metrics&quot;: [ ],
    &quot;events&quot;: [ ],
    &quot;type&quot;: &quot;TEZ_DAG_ID&quot;,
    &quot;id&quot;: &quot;dag_1465246237936_0001_000002&quot;,
    &quot;createdtime&quot;: 1465246359045,
    &quot;isrelatedto&quot;: { },
    &quot;configs&quot;: { },
    &quot;info&quot;: {
      &quot;UID&quot;: &quot;yarn-cluster!sjlee!TEZ_DAG_ID!0!dag_1465246237936_0001_000002!userX&quot;
      &quot;FROM_ID&quot;: &quot;sjlee!yarn-cluster!TEZ_DAG_ID!0!dag_1465246237936_0001_000002!userX&quot;
    },
    &quot;relatesto&quot;: { }
  }
]
</code></pre> <h4 id="response-codes-8"><a href="#response-codes-8" class="header-anchor">#</a> Response Codes</h4> <ol><li>If successful, a HTTP 200(OK) response is returned.</li> <li>If any problem occurs in parsing request, HTTP 400 (Bad Request) is returned.</li> <li>For non-recoverable errors while retrieving data, HTTP 500 (Internal Server Error) is returned.</li></ol> <h3 id="query-generic-entity-with-in-the-scope-of-application"><a href="#query-generic-entity-with-in-the-scope-of-application" class="header-anchor">#</a> Query generic entity with in the scope of Application</h3> <p>With this API, you can query a specific generic entity identified by cluster ID, application ID, per-framework entity type and entity ID. If the REST endpoint without the cluster name is used, the cluster specified by the configuration yarn.resourcemanager.cluster-id in yarn-site.xml is taken. Flow context information i.e. user, flow name and run id are not mandatory but if specified in query param can preclude the need for an additional operation to fetch flow context information based on cluster and app id. This endpoint can be used to query a single container, application attempt or any other generic entity which clients put into the backend. For instance, we can query a specific YARN container by specifying entity type as YARN_CONTAINER and giving entity ID as container ID. Similarly, application attempt can be queried by specifying entity type as YARN_APPLICATION_ATTEMPT and entity ID being the application attempt ID.</p> <h4 id="http-request-9"><a href="#http-request-9" class="header-anchor">#</a> HTTP request:</h4> <pre><code>GET /ws/v2/timeline/clusters/{cluster name}/apps/{app id}/entities/{entity type}/{entity id}

or

GET /ws/v2/timeline/apps/{app id}/entities/{entity type}/{entity id}
</code></pre> <h4 id="query-parameters-supported-9"><a href="#query-parameters-supported-9" class="header-anchor">#</a> Query Parameters Supported:</h4> <ol><li>userid - If specified, entity must belong to this user. This query param must be specified along with flowname and flowrunid query params, otherwise it will be ignored. If userid, flowname and flowrunid are not specified, we would have to fetch flow context information based on cluster and appid while executing the query.</li> <li>flowname - If specified, entity must belong to this flow name. This query param must be specified along with userid and flowrunid query params, otherwise it will be ignored. If userid, flowname and flowrunid are not specified, we would have to fetch flow context information based on cluster and appid while executing the query.</li> <li>flowrunid - If specified, entity must belong to this flow run id. This query param must be specified along with userid and flowname query params, otherwise it will be ignored. If userid, flowname and flowrunid are not specified, we would have to fetch flow context information based on cluster and appid while executing the query.</li> <li>metricstoretrieve - If specified, defines which metrics to retrieve or which ones not to retrieve and send back in response. metricstoretrieve can be an expression of the form :<br>
(<metricprefix>,<metricprefix>,<metricprefix>,<metricprefix>…)<br>
This specifies a comma separated list of metric id prefixes. Only metrics matching any of the prefixes will be retrieved. Brackets are optional for the simple expression. Alternatively, expressions can be of the form:<br>
!(<metricprefix>,<metricprefix>,<metricprefix>,<metricprefix>…)<br>
This specifies a comma separated list of metric id prefixes. Only metrics not matching any of the prefixes will be retrieved.<br>
If metricstoretrieve is specified, metrics will be retrieved irrespective of whether METRICS is specified in fields query param or not. Please note that URL unsafe characters such as spaces will have to be suitably encoded.</metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></li> <li>confstoretrieve - If specified, defines which configs to retrieve or which ones not to retrieve and send back in response. confstoretrieve can be an expression of the form :<br>
(&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;…)<br>
This specifies a comma separated list of config name prefixes. Only configs matching any of the prefixes will be retrieved. Brackets are optional for the simple expression. Alternatively, expressions can be of the form :<br>
!(&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;…)<br>
This specifies a comma separated list of config name prefixes. Only configs not matching any of the prefixes will be retrieved.<br>
If confstoretrieve is specified, configs will be retrieved irrespective of whether CONFIGS is specified in fields query param or not. Please note that URL unsafe characters such as spaces will have to be suitably encoded.</li> <li>fields - Specifies which fields to retrieve. Possible values for fields can be EVENTS, INFO, CONFIGS, METRICS, RELATES_TO, IS_RELATED_TO and ALL. All fields will be retrieved if ALL is specified. Multiple fields can be specified as a comma-separated list. If fields is not specified, in response, entity id, entity type, createdtime and UID in info field will be returned.</li> <li>metricslimit - If specified, defines the number of metrics to return. Considered only if fields contains METRICS/ALL or metricstoretrieve is specified. Ignored otherwise. The maximum possible value for metricslimit can be maximum value of Integer. If it is not specified or has a value less than 1, and metrics have to be retrieved, then metricslimit will be considered as 1 i.e. latest single value of metric(s) will be returned.</li> <li>metricstimestart - If specified, then metrics for the entity after this timestamp are returned.</li> <li>metricstimeend - If specified, then metrics for the entity before this timestamp are returned.</li> <li>entityidprefix Defines the id prefix for the entity to be fetched. If specified, then entity retrieval will be faster.</li></ol> <h4 id="example-json-response-9"><a href="#example-json-response-9" class="header-anchor">#</a> Example JSON Response:</h4> <pre><code>{
  &quot;metrics&quot;: [ ],
  &quot;events&quot;: [ ],
  &quot;type&quot;: &quot;YARN_APPLICATION_ATTEMPT&quot;,
  &quot;id&quot;: &quot;appattempt_1465246237936_0001_000001&quot;,
  &quot;createdtime&quot;: 1465246358873,
  &quot;isrelatedto&quot;: { },
  &quot;configs&quot;: { },
  &quot;info&quot;: {
    &quot;UID&quot;: &quot;yarn-cluster!application_1465246237936_0001!YARN_APPLICATION_ATTEMPT!0!appattempt_1465246237936_0001_000001&quot;
    &quot;FROM_ID&quot;: &quot;yarn-cluster!sjlee!ds-date!1460419580171!application_1465246237936_0001!YARN_APPLICATION_ATTEMPT!0!appattempt_1465246237936_0001_000001&quot;
  },
  &quot;relatesto&quot;: { }
}
</code></pre> <h4 id="response-codes-9"><a href="#response-codes-9" class="header-anchor">#</a> Response Codes</h4> <ol><li>If successful, a HTTP 200 (OK) response is returned.</li> <li>If any problem occurs in parsing request, HTTP 400 (Bad Request) is returned.</li> <li>If flow context information cannot be retrieved or entity for the given entity id cannot be found, HTTP 404 (Not Found) is returned.</li> <li>For non-recoverable errors while retrieving data, HTTP 500 (Internal Server Error) is returned.</li></ol> <h3 id="query-generic-entity"><a href="#query-generic-entity" class="header-anchor">#</a> Query generic entity.</h3> <p>With this API, you can query generic entity per user identified by cluster ID, doAsUser and entity type and entity ID. If the REST endpoint without the cluster name is used, the cluster specified by the configuration yarn.resourcemanager.cluster-id in yarn-site.xml is taken. If number of matching entities are more than the limit, the most recent entities up to the limit will be returned. This endpoint can be used to query generic entity which clients put into the backend. For instance, we can query user entities by specifying entity type as TEZ_DAG_ID. If none of the entities match the predicates, an empty list will be returned. Note : As of today, we can query only those entities which are published with doAsUser which is different from application owner.</p> <h4 id="http-request-10"><a href="#http-request-10" class="header-anchor">#</a> HTTP request:</h4> <pre><code>GET /ws/v2/timeline/clusters/{cluster name}/users/{userid}/entities/{entitytype}/{entityid}

or

GET /ws/v2/timeline/users/{userid}/entities/{entitytype}/{entityid}
</code></pre> <h4 id="query-parameters-supported-10"><a href="#query-parameters-supported-10" class="header-anchor">#</a> Query Parameters Supported:</h4> <ol><li>metricstoretrieve - If specified, defines which metrics to retrieve or which ones not to retrieve and send back in response. metricstoretrieve can be an expression of the form :<br>
(<metricprefix>,<metricprefix>,<metricprefix>,<metricprefix>…)<br>
This specifies a comma separated list of metric id prefixes. Only metrics matching any of the prefixes will be retrieved. Brackets are optional for the simple expression. Alternatively, expressions can be of the form:<br>
!(<metricprefix>,<metricprefix>,<metricprefix>,<metricprefix>…)<br>
This specifies a comma separated list of metric id prefixes. Only metrics not matching any of the prefixes will be retrieved.<br>
If metricstoretrieve is specified, metrics will be retrieved irrespective of whether METRICS is specified in fields query param or not. Please note that URL unsafe characters such as spaces will have to be suitably encoded.</metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></metricprefix></li> <li>confstoretrieve - If specified, defines which configs to retrieve or which ones not to retrieve and send back in response. confstoretrieve can be an expression of the form :<br>
(&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;…)<br>
This specifies a comma separated list of config name prefixes. Only configs matching any of the prefixes will be retrieved. Brackets are optional for the simple expression. Alternatively, expressions can be of the form:<br>
!(&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;,&lt;config_name_prefix&gt;…)<br>
This specifies a comma separated list of config name prefixes. Only configs not matching any of the prefixes will be retrieved.<br>
If confstoretrieve is specified, configs will be retrieved irrespective of whether CONFIGS is specified in fields query param or not. Please note that URL unsafe characters such as spaces will have to be suitably encoded.</li> <li>fields - Specifies which fields to retrieve. Possible values for fields can be EVENTS, INFO, CONFIGS, METRICS, RELATES_TO, IS_RELATED_TO and ALL. All fields will be retrieved if ALL is specified. Multiple fields can be specified as a comma-separated list. If fields is not specified, in response, entity id, entity type, createdtime and UID in info field will be returned.</li> <li>metricslimit - If specified, defines the number of metrics to return. Considered only if fields contains METRICS/ALL or metricstoretrieve is specified. Ignored otherwise. The maximum possible value for metricslimit can be maximum value of Integer. If it is not specified or has a value less than 1, and metrics have to be retrieved, then metricslimit will be considered as 1 i.e. latest single value of metric(s) will be returned.</li> <li>metricstimestart - If specified, then metrics for the entity after this timestamp are returned.</li> <li>metricstimeend - If specified, then metrics for the entity before this timestamp are returned.</li> <li>fromid - If specified, retrieve the next set of generic entities from the given fromid. The set of entities retrieved is inclusive of specified fromid. fromid should be taken from the value associated with FROM_ID info key in flow entity response which was sent earlier.</li></ol> <h4 id="example-json-response-10"><a href="#example-json-response-10" class="header-anchor">#</a> Example JSON Response:</h4> <pre><code>[
  {
    &quot;metrics&quot;: [ ],
    &quot;events&quot;: [ ],
    &quot;type&quot;: &quot;TEZ_DAG_ID&quot;,
    &quot;id&quot;: &quot;dag_1465246237936_0001_000001&quot;,
    &quot;createdtime&quot;: 1465246358873,
    &quot;isrelatedto&quot;: { },
    &quot;configs&quot;: { },
    &quot;info&quot;: {
      &quot;UID&quot;: &quot;yarn-cluster!sjlee!TEZ_DAG_ID!0!dag_1465246237936_0001_000001!userX&quot;
      &quot;FROM_ID&quot;: &quot;sjlee!yarn-cluster!TEZ_DAG_ID!0!dag_1465246237936_0001_000001!userX&quot;
    },
    &quot;relatesto&quot;: { }
  }
]
</code></pre> <h4 id="response-codes-10"><a href="#response-codes-10" class="header-anchor">#</a> Response Codes</h4> <ol><li>If successful, a HTTP 200(OK) response is returned.</li> <li>If any problem occurs in parsing request, HTTP 400 (Bad Request) is returned.</li> <li>For non-recoverable errors while retrieving data, HTTP 500 (Internal Server Error) is returned.</li></ol> <h3 id="query-generic-entity-types"><a href="#query-generic-entity-types" class="header-anchor">#</a> Query generic entity types</h3> <p>With this API, you can query set of available entity types for a given app id. If the REST endpoint without the cluster name is used, the cluster specified by the configuration yarn.resourcemanager.cluster-id in yarn-site.xml is taken. If userid, flow name and flow run id which are optional query parameters are not specified, they will be queried based on app id and cluster id from the flow context information stored in underlying storage implementation.</p> <h4 id="http-request-11"><a href="#http-request-11" class="header-anchor">#</a> HTTP request:</h4> <pre><code>GET /ws/v2/timeline/apps/{appid}/entity-types

or

GET /ws/v2/timeline/clusters/{clusterid}/apps/{appid}/entity-types
</code></pre> <h4 id="query-parameters-supported-11"><a href="#query-parameters-supported-11" class="header-anchor">#</a> Query Parameters Supported:</h4> <ol><li>userid - If specified, entity must belong to this user. This query param must be specified along with flowname and flowrunid query params, otherwise it will be ignored. If userid, flowname and flowrunid are not specified then timeline reader will fetch flow context information based on cluster and appid while executing the query.</li> <li>flowname - If specified, entity must belong to this flow name. This query param must be specified along with userid and flowrunid query params, otherwise it will be ignored. If userid, flowname and flowrunid are not specified, we would have to fetch flow context information based on cluster and appid while executing the query.</li> <li>flowrunid - If specified, entity must belong to this flow run id. This query param must be specified along with userid and flowname query params, otherwise it will be ignored. If userid, flowname and flowrunid are not specified, we would have to fetch flow context information based on cluster and appid while executing the query.</li></ol> <h4 id="example-json-response-11"><a href="#example-json-response-11" class="header-anchor">#</a> Example JSON Response:</h4> <pre><code>{
  YARN_APPLICATION_ATTEMPT,
  YARN_CONTAINER,
  MAPREDUCE_JOB,
  MAPREDUCE_TASK,
  MAPREDUCE_TASK_ATTEMPT
}
</code></pre> <h4 id="response-codes-11"><a href="#response-codes-11" class="header-anchor">#</a> Response Codes</h4> <ol><li>If successful, a HTTP 200 (OK) response is returned.</li> <li>If any problem occurs in parsing request, HTTP 400 (Bad Request) is returned.</li> <li>If flow context information cannot be retrieved or entity for the given entity id cannot be found, HTTP 404 (Not Found) is returned.</li> <li>For non-recoverable errors while retrieving data, HTTP 500 (Internal Server Error) is returned.</li></ol> <h2 id="aggregated-log-serving-for-historical-apps"><a href="#aggregated-log-serving-for-historical-apps" class="header-anchor">#</a> Aggregated Log Serving for Historical Apps</h2> <p>TimelineService v.2 supports serving aggregated logs of historical apps. To enable this, configure “yarn.log.server.web-service.url” to “${yarn .timeline-service.hostname}:8188/ws/v2/applicationlog” in yarn-site.xml</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/2/2019, 11:25:55 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.2396613b.js" defer></script><script src="/assets/js/2.8cd1edd2.js" defer></script><script src="/assets/js/250.1172f0d2.js" defer></script>
  </body>
</html>
